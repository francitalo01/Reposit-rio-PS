---
title: "Análise do Desempenho e Perfil dos Atletas Olímpicos: Um Panorama das Conquistas e Características Físicas de 2000 a 2016"
  
# Nome do documento PDF gerado
output-file: Análise do Desempenho e Perfil dos Atletas Olímpicos
---



```{r}
#| include: false
source("rdocs/source/packages.R")
```

```{r}
#| include: false
# Pacotes ----
pacman::p_load(tidyverse,readxl,lubridate,janitor,ggplot2,dplyr,tidytext,knitr,car,stats,patchwork,stringr,tibble)

# Diretorio de trabalho
setwd("C:/Users/Francisco Italo/Documents")

# Leitura dos dados
sydney_2000<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 4) # 2000
athina_2004<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 1) # 2004
beijing_2008<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 5) # 2008
london_2012<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 2)# 2012
rio_2016<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 3) # 2016

# Renomeando as variaveis
sydney_2000 <- sydney_2000 %>% 
  rename(c(Name = N4m3, Sex = S3x, Age = "4g3", Height = "H31ght", Weight = "W31ght", Team = T34m, Sport = Sp0rt, Event = "3v3nt", Medal = M3d4l))

athina_2004 <- athina_2004 %>% 
  rename(c(Name = Names, Sex = Gender, Age = Age, Height = "Height (cm)", Weight = "Weight (lbs)", Team = Team, Sport = Sport, Event = Event, Medal = Medal))

beijing_2008 <- beijing_2008 %>% 
  rename(c(Name = Names, Sex = Sex, Age = Age, Height = Height, Weight = Weight, Team = Team, Sport = Sport, Event = Event, Medal = Medal))

london_2012 <- london_2012 %>% 
  rename(c(Name = Name, Sex = Sex, Age = Age, Height = Height, Weight = Weight, Team = Team, Sport = Sport, Event = Event, Medal = Medal))

rio_2016 <- rio_2016 %>% 
  rename(c(Name = Name, Sex = Sex, Age = Age_year, Height = Height_cm, Weight = Weight_lbs, Team = Country, Sport = Sport, Event = Event, Medal = Medal))

# Transformando os dados ----

# Convertando lbs para kg
sydney_2000$Weight <- sydney_2000$Weight * 0.453592
athina_2004$Weight <- athina_2004$Weight * 0.453592
beijing_2008$Weight <- beijing_2008$Weight * 0.453592
london_2012$Weight <- london_2012$Weight * 0.453592
rio_2016$Weight <- rio_2016$Weight * 0.453592

# Altura cm para m

sydney_2000$Height <- sydney_2000$Height / 100
athina_2004$Height <- athina_2004$Height / 100
beijing_2008$Height <- beijing_2008$Height / 100
london_2012$Height <- london_2012$Height / 100
rio_2016$Height <- rio_2016$Height / 100

# Sexo
sydney_2000 %>% distinct(Sex)
sydney_2000$Sex <- as.factor(sydney_2000$Sex)

athina_2004 %>% distinct(Sex)
athina_2004$Sex <- as.factor(athina_2004$Sex)

beijing_2008 %>% distinct(Sex)
beijing_2008$Sex <- as.factor(beijing_2008$Sex)

london_2012 %>% distinct(Sex)
london_2012$Sex <- as.factor(london_2012$Sex)

rio_2016 %>% distinct(Sex)
rio_2016$Sex <- as.factor(rio_2016$Sex)

# Sedes das olimpiadas
sydney_2000 <- sydney_2000 %>% mutate(Olimpiada = "Sydney")
athina_2004 <- athina_2004 %>% mutate(Olimpiada = "Athina")
beijing_2008 <- beijing_2008 %>% mutate(Olimpiada = "Beijing")
london_2012 <- london_2012 %>% mutate(Olimpiada = "London")
rio_2016 <- rio_2016 %>% mutate(Olimpiada = "Rio")

# Juntando os dados

olimpiadas <- rbind(sydney_2000,athina_2004,beijing_2008,london_2012,rio_2016)

sydney_2000 <- sydney_2000 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

athina_2004 <- athina_2004 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

beijing_2008 <- beijing_2008 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

london_2012 <- london_2012 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

rio_2016 <- rio_2016 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

olimpiadas <- olimpiadas %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

# Tema da Estat
cores_estat <- c("#A11D21", "#003366", "#CC9900", "#663333", "#FF6600", "#CC9966", "#999966", "#006606", "#008091", "#041835", "#666666")

theme_estat <- function(...) {
  theme <- ggplot2::theme_bw() +
    ggplot2::theme(
      axis.title.y = ggplot2::element_text(colour = "black", size = 12),
      axis.title.x = ggplot2::element_text(colour = "black", size = 12),
      axis.text = ggplot2::element_text(colour = "black", size = 9.5),
      panel.border = ggplot2::element_blank(),
      axis.line = ggplot2::element_line(colour = "black"),
      legend.position = "top",
      ...
    )
  
  return(
    list(
      theme,
      scale_fill_manual(values = cores_estat),
      scale_colour_manual(values = cores_estat)
    )
  )
}

```

```{r}
print_quadro_resumo <- function(data, var_name, title="Medidas resumo da(o) [nome da variável]", label="quad:quadro_resumo1")
{
  var_name <- substitute(var_name)
  data <- data %>%
    summarize(`Média` = round(mean(!!sym(var_name)),2),
              `Desvio Padrão` = round(sd(!!sym(var_name)),2),
              `Variância` = round(var(!!sym(var_name)),2),
              `Mínimo` = round(min(!!sym(var_name)),2),
              `1º Quartil` = round(quantile(!!sym(var_name), probs = .25),2),
              `Mediana` = round(quantile(!!sym(var_name), probs = .5),2),
              `3º Quartil` = round(quantile(!!sym(var_name), probs = .75),2),
              `Máximo` = round(max(!!sym(var_name)),2)) %>%
    t() %>%
    as.data.frame() %>%
    rownames_to_column()
  latex <- str_c("\\begin{quadro}[H]
\t\\setlength{\t\\tabcolsep}{9pt}
\t\\renewcommand{\t\\arraystretch}{1.20}
\t\\caption{", title, "}
\t\\centering
\t\\begin{tabular} {", sep="")
  col_count <- ncol(data)
  row_count <- nrow(data)
  latex <- str_c(latex, "| l |\n", sep=" ")
  for (i in seq(2, col_count))
  {
    numCount <- data[i, -c(1)] %>%
      as.numeric() %>%
      {floor(log10(.)) + 1} %>%
      max()
    latex <- str_c(latex, "\t\t\tS[table-format = ", numCount ,".2]\n", sep="")
  }
  latex <- str_c(latex, "\t\t\t|}\n\t\\hline\n\t\t", sep="")
  if (col_count > 2)
  {
    for (i in seq(1,col_count))
    {
      if (i == 1)
        latex <- str_c(latex, "\\textbf{Estatística}", sep="")
      else
        latex <- str_c(latex, " \\textbf{", data[1, i], "}", sep="")
      if (i < col_count)
        latex <- str_c(latex, "&", sep=" ")
      else
        latex <- str_c(latex, "\\\\\n", sep=" ")
    }
  }
  else
  {
    latex <- str_c(latex, "\\textbf{Estatística} & \\textbf{Valor} \\\\\n", sep="")
  }
  latex <- str_c(latex, "\t\t\\hline\n", sep="")
  if (col_count > 2)
    starting_number <- 2
  else
    starting_number <- 1
  for (i in seq(starting_number, row_count))
  {
    latex <- str_c(latex, "\t\t", str_flatten(t(data[i,]), collapse = " & "), " \\\\\n")
  }
  latex <- str_c(latex, "\t\\hline
\t\\end{tabular}
\t\\label{", label, "}
\\end{quadro}", sep="")
  writeLines(latex)
}
```


# Introdução

O projeto tem como objetivo auxiliar João Neves, proprietário da academia de alta performance House of Excellence, na otimização do desempenho de seus atletas de elite, com base em análises estatísticas de suas participações nas edições dos Jogos Olímpicos de 2000 a 2016. O foco das análises é identificar padrões de desempenho, características físicas e fatores relacionados às conquistas de medalhas, oferecendo insights valiosos para melhorar a preparação e a performance futura dos atletas.

O banco de dados foi fornecidos pelo cliente separado por paises sede da olimpiada e ano de sua realização e contém as seguintes variáveis: nome do atleta, sexo, idade, altura, peso, país que o atleta compete, esporte, evento e tipo de medalha. A primeira análise identifica os cinco países com maior número de mulheres medalhistas, classificando-os em ordem decrescente de conquistas femininas. Já a segunda análise calculou o IMC de atletas em atletismo, badminton, futebol, ginástica e judô, para comparar a variação do índice entre esportes e verificar diferenças significativas, aplicando a ANOVA para essa comparação. Em seguida, a análise dos três maiores medalhistas em quantidade total de medalhas avaliará a frequência de medalhas de ouro, prata e bronze conquistadas por cada um e as associações entre o tipo de medalha e o atleta. Para entender a relação entre peso e altura, será realizada uma regressão linear, investigando se há correlação positiva, negativa ou inexistente entre essas variáveis. Essas análises combinam métodos descritivos, testes de hipóteses e regressão.

As análises foram realizadas utilizando o software R, versão 4.4.1, com pacotes especializados para manipulação de dados, visualização gráfica e modelagem estatística.


# Referencial Teórico

Este relatório é composto por técnicas estatísticas que serão descritas a seguir de acordo com o que foi utilizado em tal estudo.

## Frequência Relativa

A frequência relativa é utilizada para a comparação entre classes de uma variável categórica com $c$ categorias, ou para comparar uma mesma categoria em diferentes estudos.

A frequência relativa da categoria $j$ é dada por:

$$
f_j=\frac{n_j}{n}
$$

Com:

-   $j = 1, \, ..., \, c$

-   $n_j =$ número de observações da categoria $j$

-   $n =$ número total de observações

Geralmente, a frequência relativa é utilizada em porcentagem, dada por:

$$100 \times f_j$$

## Média

A média é a soma das observações dividida pelo número total delas, dada pela fórmula:

$$\bar{X}=\frac{\sum\limits_{i=1}^{n}X_i}{n}$$

Com:

-   $i = 1, \, 2, \, ..., \, n$

-   $n =$ número total de observações

## Mediana

Sejam as $n$ observações de um conjunto de dados $X=X_{(1)},X_{(2)},\ldots, X_{(n)}$ de determinada variável ordenadas de forma crescente. A mediana do conjunto de dados $X$ é o valor que deixa metade das observações abaixo dela e metade dos dados acima.

Com isso, pode-se calcular a mediana da seguinte forma:

$$
med(X) =
    \begin{cases}
         X_{\frac{n+1}{2}}, \textrm{para n ímpar} \\
         \frac{X_{\frac{n}{2}}+X_{\frac{n}{2} + 1}}{2}, \textrm{para n par} \\
    \end{cases}
$$

## Quartis

Os quartis são separatrizes que dividem o conjunto de dados em quatro partes iguais. O primeiro quartil (ou inferior) delimita os 25% menores valores, o segundo representa a mediana, e o terceiro delimita os 25% maiores valores. Inicialmente deve-se calcular a posição do quartil:

-   Posição do primeiro quartil $P_1$: $$P_1=\frac{n+1}{4}$$

-   Posição da mediana (segundo quartil) $P_2$: $$P_2 = \frac{n+1}{2}$$

-   Posição do terceiro quartil $P_3$: $$P_3=\frac{3 \times (n+1)}{4}$$

Com $n$ sendo o tamanho da amostra. Dessa forma, $X_{\left( P_i \right)}$ é o valor do $i$-ésimo quartil, onde $X_{\left( j \right)}$ representa a $j$-ésima observação dos dados ordenados.

Se o cálculo da posição resultar em uma fração, deve-se fazer a média entre o valor que está na posição do inteiro anterior e do seguinte ao da posição.

## Variância

A variância é uma medida que avalia o quanto os dados estão dispersos em relação à média, em uma escala ao quadrado da escala dos dados.

### Variância Amostral

Para uma amostra, a variância é dada por:

$$S^2=\frac{\sum\limits_{i=1}^{n}\left(X_i - \bar{X}\right)^2}{n-1}$$

Com:

-   $X_i =$ i-ésima observação da amostra

-   $\bar{X} =$ média amostral

-   $n =$ tamanho da amostra

## Desvio Padrão

O desvio padrão é a raiz quadrada da variância. Ele avalia o quanto os dados estão dispersos em relação à média.


### Desvio Padrão Amostral

Para uma amostra, o desvio padrão é dado por:

$$S=\sqrt{\frac{\sum\limits_{i=1}^{n}\left(X_i - \bar{X}\right)^2}{n-1}}$$

Com:

-   $X_i =$ i-ésima observação da amostra

-   $\bar{X} =$ média amostral

-   $n =$ tamanho da amostra

## Coeficiente de Variação

O coeficiente de variação fornece a dispersão dos dados em relação à média. Quanto menor for o seu valor, mais homogêneos serão os dados. O coeficiente de variação é considerado baixo (apontando um conjunto de dados homogêneo) quando for menor ou igual a 25%. Ele é dado pela fórmula:

$$C_V=\frac{S}{\bar{X}}\times 100$$

Com:

-   $S =$ desvio padrão amostral

-   $\bar{X} =$ média amostral

## Coeficiente de Assimetria

O coeficiente de assimetria quantifica a simetria dos dados. Um valor positivo indica que os dados estão concentrados à esquerda em sua função de distribuição, enquanto um valor negativo indica maior concentração à direita. A fórmula é:

$$C_{Assimetria} = \frac{1}{n}\times\sum\limits_{i=1}^{n} \left(\frac{X_i - \bar{X}}{S}\right)^3 $$

Com:

-   $X_i =$ i-ésima observação da amostra

-   $\bar{X} =$ média amostral

-   $S=$ desvio padrão amostral

-   $n=$ tamanho da amostra

## Coeficiente de Correlação de Pearson

O coeficiente de correlação de Pearson é uma medida que verifica o grau de relação linear entre duas variáveis quantitativas. Este coeficiente varia entre os valores -1 e 1. O valor zero significa que não há relação linear entre as variáveis. Quando o valor do coeficiente $r$ é negativo, diz-se existir uma relação de grandeza inversamente proporcional entre as variáveis. Analogamente, quando $r$ é positivo, diz-se que as duas variáveis são diretamente proporcionais.

O coeficiente de correlação de Pearson é normalmente representado pela letra $r$ e a sua fórmula de cálculo é:

$$
r_{Pearson} = \frac{\displaystyle \sum_{i=1}^{n} \left [ \left(x_i-\bar{x}\right) \left(y_i-\bar{y}\right) \right]}{\sqrt{\displaystyle \sum_{i=1}^{n} x_i^2 - n\bar{x}^2}  \times \sqrt{\displaystyle \sum_{i=1}^{n} y_i^2 - n\bar{y}^2}}
$$

Onde:

-   $x_i =$ i-ésimo valor da variável $X$
-   $y_i =$ i-ésimo valor da variável $Y$
-   $\bar{x} =$ média dos valores da variável $X$
-   $\bar{y} =$ média dos valores da variável $Y$

Vale ressaltar que o coeficiente de Pearson é paramétrico e, portanto, sensível quanto à normalidade (simetria) dos dados.

## Boxplot

O boxplot é uma representação gráfica na qual se pode perceber de forma mais clara como os dados estão distribuídos. A figura abaixo ilustra um exemplo de boxplot.

![Exemplo de boxplot](images/box_uni.png){fig-align="center"}

A porção inferior do retângulo diz respeito ao primeiro quartil, enquanto a superior indica o terceiro quartil. Já o traço no interior do retângulo representa a mediana do conjunto de dados, ou seja, o valor em que o conjunto de dados é dividido em dois subconjuntos de mesmo tamanho. A média é representada pelo losango branco e os pontos são *outliers*. Os *outliers* são valores discrepantes da série de dados, ou seja, valores que não demonstram a realidade de um conjunto de dados.

## Histograma

O histograma é uma representação gráfica utilizada para a visualização da distribuição dos dados e pode ser construído por valores absolutos, frequência relativa ou densidade. A figura abaixo ilustra um exemplo de histograma.

![Exemplo de histograma](images/hist_uni.png){fig-align="center"}

## Gráfico de Dispersão

O gráfico de dispersão é uma representação gráfica utilizada para ilustrar o comportamento conjunto de duas variáveis quantitativas. A figura abaixo ilustra um exemplo de gráfico de dispersão, onde cada ponto representa uma observação do banco de dados.

![Exemplo de Gráfico de Dispersão](images/disp_uni.png){fig-align="center"}

## Tipos de Variáveis

### Qualitativas

As variáveis qualitativas são as variáveis não numéricas, que representam categorias ou características da população. Estas subdividem-se em:

-   **Nominais**: quando não existe uma ordem entre as categorias da variável (exemplos: sexo, cor dos olhos, fumante ou não, etc)
-   **Ordinais**: quando existe uma ordem entre as categorias da variável (exemplos: nível de escolaridade, mês, estágio de doença, etc)

### Quantitativas

As variáveis quantitativas são as variáveis numéricas, que representam características numéricas da população, ou seja, quantidades. Estas subdividem-se em:

-   **Discretas**: quando os possíveis valores são enumeráveis (exemplos: número de filhos, número de cigarros fumados, etc)
-   **Contínuas**: quando os possíveis valores são resultado de medições (exemplos: massa, altura, tempo, etc)

## Teste de Normalidade de Shapiro-Wilk

O **Teste de Shapiro-Wilk** é utilizado para verificar a aderência de uma variável quantitativa ao modelo da Distribuição Normal, sendo mais recomendado para amostras pequenas. A suposição de normalidade é importante para a determinação do teste a ser utilizado. As hipóteses a serem testadas são:

\hipoteses{A variável segue uma distribuição Normal}{A variável segue outro modelo}

A amostra deve ser ordenada de forma crescente para que seja possível obter as estatísticas de ordem. A estatística do teste é dada por:

$$ W = \frac{1}{D} \left[ \sum_{i=1}^{k} a_{i} \left(X_{(n-i+1)} - X_{(i)}\right) \right] $$

Com:

-   $K$ aproximadamente $\displaystyle\frac{n}{2}$

-   $X_{\left(i\right)} =$ estatística de ordem *i*

-   $D = \displaystyle \sum_{i=1}^{n}(X_{i} - \bar{X})^2$, em que $\bar{X}$ é a média amostral

-   \$a_i = \$ constantes que apresentam valores tabelados


## Teste de Kruskal-Wallis

O teste de Kruskal-Wallis é utilizado para comparar dois ou mais grupos independentes sem supor nenhuma distribuição. É um método baseado na comparação de postos, os quais são atribuídos a cada observação de uma variável quantitativa após serem ordenadas.

As hipóteses do teste de Kruskal-Wallis são formuladas da seguinte maneira:

\hipoteses{Não existe diferença entre os grupos}{Pelo menos um grupo difere dos demais}

A estatística do teste de Krukal-Waliis é definida da seguinte maneira:

$$
H_{Kruskal-Wallis}=
    \displaystyle\frac{\displaystyle\left[ \frac{12}{n(n+1)} \sum_{i=1}^{k} \frac{R_i^2}{n_i} \right] - 3(n+1)}
    {\displaystyle1- \left[ \frac{\displaystyle\sum_{j}^{}(t_j^3 - t_j)}{n^3 - n}\right]} 
\approx \chi^2_{(k-1)}
$$

Com: - $k=$ número de grupos

-   $R_i=$ soma dos postos do grupo i

-   $n_i=$ número de elementos do grupo i

-   $n=$ tamanho total da amostra

-   $t_{j}=$ número de elementos no j-ésimo empate (se houver)

Se o p-valor for menor que o nível de significância $\alpha$, rejeita-se a hipótese nula.

## Teste de Normalidade de Anderson-Darling

O **teste de Normalidade de Anderson-Darling** é utilizado para verificar se uma amostra aleatória $X_1, X_2, ..., X_n$ de uma variável quantitativa segue uma distribuição Normal de probabilidade ou não. O teste possui as seguintes hipóteses:

\begin{center}
\hipoteses{A variável segue uma distribuição Normal}{A variável segue outro modelo}
\end{center}

Se a hipótese nula for verdadeira, espera-se que o p-valor esteja acima do nível de significância $\alpha$.




# Análises

## Top 5 países com maior número de mulheres medalhistas únicas

Na análise, busca-se identificar os países que tiveram o maior número de mulheres medalhistas nos Jogos Olímpicos de 2000 a 2016. Utilizou-se dados das edições de Sydney 2000, Atenas 2004, Pequim 2008, Londres 2012 e Rio 2016, considerando as variáveis de sexo (feminino), país de origem das atletas (Time), e a presença de uma medalha (Medalha). As três variáveis estudadas são variáveis qualitativas nominais. O objetivo principal foi compreender quais nações se destacaram em termos de conquistas femininas, sem duplicações de resultados, ou seja, apenas o número de mulheres medalhistas únicas. Utilizando como métricas o número total de medalhistas por país e a frequência relativa de cada país em relação ao total de mulheres medalhistas.

```{r fig.cap="Gráfico de barras dos 5 países com maior número de mulheres medalhistas", fig.align="center"}
# 1. Top 5 países com maior número de mulheres medalhistas (13/10)----
# O cliente gostaria de entender quais países possuem um maior número de mulheres que conquistaram medalhas, em ordem do país com maior número de mulheres medalhistas para o país com menor número.

# Total (Tabela pronta, mas falta colocar a padronização da Estat)
top_5_total <- olimpiadas %>%
  filter(Sexo == "F", !is.na(Medalha)) %>%
  distinct(Time, Nome, .keep_all = TRUE) %>%
  group_by(Time) %>%
  summarise(total_medalhistas = n(), .groups = 'drop') %>% 
  arrange(desc(total_medalhistas))  %>%
  mutate (freq = round(100*(total_medalhistas/sum(total_medalhistas)), 2))  %>%
  mutate(freq = gsub("\\.", ",", freq) %>% 
           paste("%", sep = ""),label = str_c(total_medalhistas, " (", freq, ")") 
         %>% str_squish())%>%
  slice_head(n = 5)

traducoes <- c(
  "United States" = "Estados Unidos",
  "Russia" = "Rússia",
  "China" = "China",
  "Australia" = "Austrália",
  "Germany" = "Alemanha"
)

top_5_total$Time <- traducoes[top_5_total$Time]

ggplot(top_5_total)+
  aes(x = reorder(Time, -total_medalhistas), y = total_medalhistas, label = label) +
  geom_bar(stat = "identity", fill = c("#A11D21"), width = 0.7) +
  geom_text(aes(label = label), position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
  labs(x = "País", y = "Número de Mulheres Medalhistas") +
  ylim(NA,600)+
  theme_estat()
```

Entre os anos de 2000 a 2016, os Estados Unidos se destacaram como o país com o maior número de mulheres medalhistas nas Olimpíadas, totalizando 443 atletas únicas, o que representa 13,62% do total de mulheres medalhistas analisadas. Em segundo lugar, a Rússia registrou 298 mulheres medalhistas, correspondendo a 9,16% do total. A China ocupa a terceira posição com 268 medalhistas, o que equivale a 8,24% do total. A Austrália, com 219 atletas únicas (6,73%), é o quarto colocado. Por fim, a Alemanha completa o top 5 com 188 medalhistas, representando 5,78% do total.

## Análise do IMC para os esportes selecionados

Nesta análise, busca-se comparar o Índice de Massa Corporal (IMC) de atletas olímpicos que competiram em diferentes modalidades esportivas, especificamente Atletismo, Badminton, Futebol, Ginástica e Judô. As variáveis trabalhadas foram as seguintes: esporte é uma variável qualitativa nominal, altura variável quantitativa contínua e peso é uma variável quantitativa contínua. Depois de calculado o IMC temos que ele é uma variável quantitativa contínua. O objetivo é identificar se há diferenças significativas nos valores de IMC entre esses esportes, bem como entender quais esportes tendem a ter IMC mais altos ou mais baixos.

O cálculo do IMC é dado pela seguinte fórmula:

$$
IMC = \frac{Peso(kg)}{Altura(m^2)}
$$
Em termos gerais, os valores de IMC podem ser categorizados da seguinte forma:


\begin{itemize}
    \item Abaixo de 18,5: Peso abaixo do ideal.
    \item 18,5 a 24,9: Peso normal ou saudável.
    \item 25,0 a 29,9: Sobrepeso.
    \item 30,0 a 34,9: Obesidade grau I.
    \item 35,0 a 39,9: Obesidade grau II.
    \item Acima de 40,0: Obesidade grau III.
\end{itemize}

```{r}
# 2 Valor IMC por esporte, estes sendo, ginástica, futebol, judô, atletismo e badminton (20/10) ----

# O cliente deseja comparar os valores do Índice de Massa Corporal (IMC) entre atletas de
# diferentes esportes, especificamente ginástica, judô, atletismo e badminton, para entender a
# variação entre eles e identificar se algum esporte tende a ter IMCs geralmente menores,
# maiores ou se não há diferença significativa. Para isso, é necessário calcular o IMC de cada
# atleta utilizando a fórmula peso (kg) / altura (m)2 e, em seguida, analisar os resultados para cada
# esporte selecionado, observando como os valores se comportam em relação aos esportes
# mencionados.

sydney_2000 <- sydney_2000 %>% 
  mutate(IMC = Peso / (Altura^2))

athina_2004 <- athina_2004 %>% 
  mutate(IMC = Peso / (Altura^2))

beijing_2008 <- beijing_2008 %>% 
  mutate(IMC = Peso / (Altura^2))

london_2012 <- london_2012 %>% 
  mutate(IMC = Peso / (Altura^2))

rio_2016 <- rio_2016 %>% 
  mutate(IMC = Peso / (Altura^2))

# Juntando os dados

olimpiadas <- rbind(sydney_2000,athina_2004,beijing_2008,london_2012,rio_2016)

traducoes_esportes <- c(
  "Athletics" = "Atletismo",
  "Badminton" = "Badminton",
  "Gymnastics" = "Ginástica",
  "Judo" = "Judô",
  "Sailing" = "Vela",
  "Wrestling" = "Luta",
  "Rowing" = "Remo",
  "Swimming" = "Natação",
  "Taekwondo" = "Taekwondo",
  "Diving" = "Saltos Ornamentais",
  "Football" = "Futebol",
  "Tennis" = "Tênis",
  "Cycling" = "Ciclismo",
  "Hockey" = "Hóquei",
  "Weightlifting" = "Levantamento de Peso",
  "Basketball" = "Basquete",
  "Volleyball" = "Voleibol",
  "Shooting" = "Tiro Esportivo",
  "Synchronized Swimming" = "Nado Sincronizado",
  "Boxing" = "Boxe",
  "Table Tennis" = "Tênis de Mesa",
  "Baseball" = "Beisebol",
  "Handball" = "Handebol",
  "Fencing" = "Esgrima",
  "Canoeing" = "Canoagem",
  "Water Polo" = "Polo Aquático",
  "Beach Volleyball" = "Vôlei de Praia",
  "Softball" = "Softbol",
  "Rhythmic Gymnastics" = "Ginástica Rítmica",
  "Archery" = "Tiro com Arco",
  "Equestrianism" = "Hipismo",
  "Modern Pentathlon" = "Pentatlo Moderno",
  "Triathlon" = "Triatlo",
  "Trampolining" = "Ginástica de Trampolim",
  "Rugby Sevens" = "Rúgbi de Sete",
  "Golf" = "Golfe"
)

olimpiadas <- olimpiadas %>% 
  mutate(Esporte = dplyr::recode(Esporte, !!!traducoes_esportes))

olimpiadas_IMC <- olimpiadas %>%
  filter(Esporte %in% c("Badminton", "Atletismo", "Judô", "Ginástica", "Futebol"), !is.na(Medalha))%>%
  distinct(Nome, .keep_all = TRUE)
```

```{r fig.cap="Boxplot da Comparação do IMC entre Esportes", fig.align="center"}

ggplot(olimpiadas_IMC, aes(x = Esporte, y = IMC, fill = Esporte)) +
  geom_boxplot(fill = c("#A11D21"), width = 0.5)+
  stat_summary(fun = "mean", geom = "point", shape = 23, size = 3, fill = "white")+
  labs(x = "Esporte", y = "IMC") +
  theme_estat()
```

Observa-se que os atletas de Atletismo e Badminton tendem a ter uma mediana de IMC menor em comparação aos de Ginástica e Judô, sugerindo que essas duas modalidades têm atletas com IMC menores. O Judô apresenta a maior mediana entre os esportes analisados, indicando uma tendência a ter um IMC mais elevados entre seus atletas. O Judô se destaca por ter uma caixa maior, sugerindo mais variação no IMC dos seus atletas em comparação aos outros esportes. Por outro lado, os da Ginástica é menor, o que indica uma menor variação no IMC dos atletas dessa modalidade.

O boxplot também exibe varios pontos fora dos limites, também conhecidos com outliers, que representam valores atípicos. Esportes como Atletismo e Judô apresentam uma quantidade significativa de outliers, com alguns atletas tendo IMC consideravelmente mais altos que a maioria de seus pares na mesma modalidade.

```{r}
estatisticas_IMC <- olimpiadas_IMC %>%
  group_by(Esporte) %>%
  summarise(
    Tamanho_amostral = n(),
    Média = round(mean(IMC, na.rm = TRUE), 2),
    Mediana = round(median(IMC, na.rm = TRUE), 2),
    Desvio_padrão = round(sd(IMC, na.rm = TRUE), 2),
    Mín = round(min(IMC, na.rm = TRUE), 1),
    Máx = round(max(IMC, na.rm = TRUE), 1)
  )
#knitr::kable(estatisticas_IMC, caption = "Tabela das estatísticas descritivas por esporte", col.names = c("Esporte","Tamanho Amostral","Média","Mediana","Desvio padrão","Min","Max"))
```

```{=latex}

\begin{quadro}[H]
\centering
\caption{Estatísticas descritivas por esporte}
\setlength{\tabcolsep}{5pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|c|c|c|c|}
       \hline
       \textbf{Esporte} & \textbf{Tamanho Amostral} & \textbf{Média} & \textbf{Mediana} & \textbf{Desvio Padrão} & \textbf{Min} & \textbf{Max} \\
       \hline
       Atletismo & 691 & 22,39 & 21,46 & 4,01 & 15,8 & 44,4 \\
       Badminton & 92 & 22,18 & 22,20 & 1,59 & 18,9 & 26,7 \\
       Futebol & 447 & 22,57 & 22,55 & 1,77 & 16,7 & 29,1 \\
       Ginástica & 200 & 20,69 & 21,09 & 2,42 & 15,2 & 26,4 \\
       Judô & 231 & 25,61 & 24,62 & 5,05 & 18,5 & 56,5 \\
       \hline
\end{tabular}
\label{estatisticasdescritivas}
\end{quadro}


```

No Atletismo, a média do IMC é de aproximadamente 22,39, com uma mediana de 21,46 e um desvio padrão de 4,01. Isso indica que, embora a maioria dos atletas de Atletismo tenha um IMC próximo à média, há certa variabilidade, com valores extremos como o máximo de 44,4, sugerindo diferenças significativas entre os atletas dessa modalidade. Para os atletas de Badminton, a média de IMC é de 22,18 e a mediana é de 22,20, com um desvio padrão de apenas 1,59. Esse baixo desvio padrão indica uma menor variabilidade nos valores de IMC, sugerindo que a maioria dos atletas de Badminton possui valores próximos da média, sem grandes desvios.

No Futebol, a média de IMC é ligeiramente superior, de 22,57, e a mediana é de 22,54, com um desvio padrão de 1,77. Essa baixa variabilidade também indica que a maioria dos jogadores apresenta valores de IMC semelhantes, concentrando-se em torno da média. Na Ginástica, a média do IMC é de 20,69, com uma mediana de 21,09 e um desvio padrão de 2,42. Esse valor relativamente baixo de desvio padrão aponta para uma variabilidade pequena, com a maioria dos ginastas concentrados em torno da média, refletindo uma distribuição homogênea de IMC entre os atletas.

Por fim, no Judô, a média do IMC é a mais alta entre os esportes analisados, com 25,61, enquanto a mediana é de 24,62 e o desvio padrão é de 5,05. Esse alto desvio padrão indica uma grande variabilidade entre os judocas, com um valor máximo de 56,5, sugerindo que alguns atletas possuem IMC significativamente mais altos, o que pode estar relacionado às exigências físicas do esporte, onde uma maior massa corporal é frequentemente vantajosa.

Esses dados mostram que os judocas tendem a ter IMC mais elevados e variáveis, enquanto os ginastas possuem os menores valores de IMC e menor variabilidade. As diferenças de variabilidade e valores médios refletem as demandas físicas específicas de cada esporte, com esportes de força e contato, como o Judô, exigindo maior massa muscular, enquanto esportes que demandam agilidade, como Ginástica e Atletismo, favorecem IMC mais baixos.




### Normalidade

O teste de Shapiro-Wilk foi aplicado para cada esporte para verificar se os dados de IMC seguem uma distribuição normal.

```{r}
# Verificar a normalidade dos dados com o teste de Shapiro-Wilk
teste_shapiro<- shapiro.test(olimpiadas_IMC$IMC)

# Formatar o p-valor em notação científica
p_valor_shapiro <- format(teste_shapiro$p.value, scientific = TRUE)

#knitr::kable(data.frame(P_valor = p_valor_shapiro), caption = "Teste de Shapiro-Wilk", col.names = "P-valor")
```


\begin{center}
\hipoteses{A distribuição dos dados de IMC para cada esporte é normal.}{A distribuição dos dados de IMC para cada esporte não é normal.}
\end{center}

```{=latex}
\begin{quadro}[H]
\centering
\caption{P-valor do Teste de Shapiro-Wilk}
\setlength{\tabcolsep}{18pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|}
       \hline
       \textbf{Teste} & \textbf{P-valor} & \textbf{Decisão do teste} \\
       \hline
       Shapiro-Wilk & \textless 0,001 & Rejeita $H_0$ \\
       \hline
\end{tabular}
\label{shapirowilk}
\end{quadro}

```


O valor do p-valor resultante para todos os atletas dos esportes selecionados foi extremamente baixo, menores que um nível de significância preestabelecido de 5%, indicando que os dados não seguem uma distribuição normal.


### Teste de Kruskal-Wallis

Dada a violação da normalidade, foi aplicado o teste de Kruskal-Wallis, que é um teste não-paramétrico.

```{r}
# Caso os pressupostos de ANOVA não sejam atendidos, utilizar o teste de Kruskal-Wallis
kruskal_result <- kruskal.test(IMC ~ Esporte, data = olimpiadas %>% filter(Esporte %in% c("Ginástica", "Judô", "Atletismo","Futebol", "Badminton")))
result_df <- data.frame(
  Estatística = kruskal_result$statistic,
  p_value = kruskal_result$p.value,
  Número_de_grupos = length(unique(olimpiadas$Esporte)),
  Tamanho_da_amostra = nrow(olimpiadas)
)
result_df$p_value <- format(result_df$p_value, scientific = TRUE)
#knitr::kable(result_df, caption = "Teste de Kruskal-Wallis", col.names = c("","Estatística", "P-valor", "Grupos", "Tamanho amostral"))
```

\begin{center}
\hipoteses{Não há diferença significativa nas distribuições de IMC entre as modalidades esportivas; ou seja, os valores de IMC têm a mesma mediana entre os grupos.}{Há pelo menos uma diferença significativa nas distribuições de IMC entre as modalidades esportivas; ou seja, os valores de IMC diferem entre os grupos.}
\end{center}

```{=latex}
\begin{quadro}[H]
\centering
\caption{P-valor do Teste de Kruskal-Wallis}
\setlength{\tabcolsep}{7pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|c|}
       \hline
        \textbf{Teste}& \textbf{Estatística do teste} & \textbf{P-valor} & \textbf{Decisão do teste}  \\
       \hline
       Kruskal-Wallis qui-quadrado & 1984,40 & \textless 0,001 & Rejeita $H_0$ \\
       \hline
\end{tabular}
\label{kruskalwallis}
\end{quadro}

```
O resultado do p-valor foi menor que 5%, indicando diferenças significativas do IMC entre os grupos de esportes.

## Top 3 medalhistas gerais por quantidade de cada tipo de medalha


A análise tem como objetivo identificar os três atletas com mais medalhas nas Olimpíadas de 2000 a 2016, além de examinar a quantidade de cada tipo de medalha (ouro, prata e bronze) conquistada por eles. As variáveis utilizadas foram nome dos medalhistas variável qualitativa nominal, número de medalhas variável quantitativa discreta, tipo de medalha variável qualitativa nominal e quantidade de medalhas por tipo variável quantitativa discreta. Também será investigada, por meio de métodos estatísticos como o teste qui-quadrado de independência, a existência de uma relação entre o atleta e o tipo de medalha.

```{r, echo=FALSE}
# 3) Top 3 medalhistas gerais por quantidade de cada tipo de medalha (27/10) ----
# O intuito dessa análise é primeiro entender quais são os 3 medalhistas com maior número de
# medalhas no total, e dentre eles, observar a quantidade de cada tipo de medalha que cada um
# destes atletas conquistou, sendo ouro, prata ou bronze. Existe relação entre o medalhista e
# cada tipo de medalha conquistada?

dados_medalha <- olimpiadas

# Remover linhas com valores ausentes, se houver
dados_medalha <- na.omit(dados_medalha)

# str(dados_medalha)
```

```{r}
medalhas_contadas <- dados_medalha %>%
  group_by(Nome) %>%
  summarise(Total_Medalhas = n())

top_3_medalhistas <- medalhas_contadas %>%
  top_n(3, Total_Medalhas)

top_3_atletas <- dados_medalha %>%
  filter(Nome %in% top_3_medalhistas$Nome)

tipo_medalha <- top_3_atletas %>%
  group_by(Nome, Medalha) %>%
  summarise(Count = n())

# Nomes dos atletas
nomes_atletas <- c(
  "Michael Fred Phelps, II" = "Michael Fred Phelps",
  "Natalie Anne Coughlin (-Hall)" = "Natalie Anne Coughlin",
  "Ryan Steven Lochte" = "Ryan Steven Lochte"
)

top_3_medalhistas <- top_3_medalhistas %>% 
  mutate(Nome = dplyr::recode(Nome, !!!nomes_atletas))

top_3_atletas <- top_3_atletas %>% 
  mutate(Nome = dplyr::recode(Nome, !!!nomes_atletas))

tipo_medalha <- tipo_medalha %>% 
  mutate(Nome = dplyr::recode(Nome, !!!nomes_atletas))

# Tradução das medalhas

traducoes_medalha <- c(
  "Gold" = "Ouro",
  "Silver" = "Prata",
  "Bronze" = "Bronze"
)

tipo_medalha <- tipo_medalha %>% 
  mutate(Medalha = dplyr::recode(Medalha, !!!traducoes_medalha))

tipo_medalha <- tipo_medalha %>%
  mutate(Medalha = factor(Medalha, levels = c("Ouro", "Prata", "Bronze")))


olimpiadas <- olimpiadas %>% 
  mutate(Medalha = dplyr::recode(Medalha, !!!traducoes_medalha))

olimpiadas <- olimpiadas %>%
  mutate(Medalha = factor(Medalha, levels = c("Ouro", "Prata", "Bronze")))

```


```{r fig.cap="Gráfico de barras da distribuição das medalhas", fig.align="center"}
# Gráfico de barras mostrando a contagem de medalhas por tipo para os Top 3 atletas

ggplot(tipo_medalha, aes(x = Nome, y = Count, fill = Medalha)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Distribuição de Medalhas para os Top 3 Atletas Olímpicos",
       x = "Atleta", y = "Quantidade de Medalhas") +
  scale_fill_manual(values = c("#A11D21", "#003366", "#CC9900"))
```

A distribuição das medalhas foi visualizada em um gráfico de barras que evidenciou o predomínio de medalhas de ouro nas conquistas de Michael Phelps, enquanto Natalie Coughlin e Ryan Lochte apresentaram uma proporção mais distribuída entre os diferentes tipos de medalha.

```{r}

#knitr::kable(top_3_medalhistas, caption = "Tabela dos Medalhistas e Total de Medalhas",col.names = c("Nome","Total de Medalhas"))
```

```{=latex}
\begin{quadro}[H]
\centering
\caption{Tabela dos Medalhistas e Total de Medalhas}
\setlength{\tabcolsep}{9pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|}
       \hline
       \textbf{Nome} & \textbf{Total de Medalhas} \\
       \hline
       Michael Fred Phelps & 28 \\
       Natalie Anne Coughlin & 12 \\
       Ryan Steven Lochte & 12 \\
       \hline
\end{tabular}
\label{medalhistas}
\end{quadro}

```

Com base na tabela, identifica-se que os três atletas com o maior número de medalhas em todas as edições analisadas foram: Michael Fred Phelps, II, com um total de 28 medalhas; Natalie Anne Coughlin, com 12 medalhas; e Ryan Steven Lochte, também com 12 medalhas.

```{r}

#knitr::kable(tipo_medalha, caption = "Tabela da Distribuição das Medalhas", col.names = c("Nome","Medalha","Quantidade"))
```

```{=latex}
\begin{quadro}[H]
\centering
\caption{Tabela da Distribuição das Medalhas}
\setlength{\tabcolsep}{9pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|}
       \hline
       \textbf{Nome} & \textbf{Medalha} & \textbf{Quantidade} \\
       \hline
       Michael Fred Phelps & Ouro & 23 \\
       Michael Fred Phelps & Prata & 3 \\
       Michael Fred Phelps & Bronze & 2 \\
       Natalie Anne Coughlin & Ouro & 3 \\
       Natalie Anne Coughlin & Prata & 4 \\
       Natalie Anne Coughlin & Bronze & 5 \\
       Ryan Steven Lochte & Ouro & 6 \\
       Ryan Steven Lochte & Prata & 0 \\
       Ryan Steven Lochte & Bronze & 3 \\
       \hline
\end{tabular}
\label{distribuicao_medalhas}
\end{quadro}

```

A distribuição das medalhas revelou-se diferenças significativas entre os atletas. Michael Phelps, que se destacou como o maior medalhista, conquistou 23 medalhas de ouro, 3 de prata e 2 de bronze, tendo um desempenho excepcional em conquistas medalhas de ouro. Natalie Coughlin, por outro lado, teve uma distribuição mais equilibrada, com 3 medalhas de ouro, 4 de prata e 5 de bronze. Já Ryan Lochte obteve 6 medalhas de ouro, 3 de prata e 3 de bronze, também apresentando um perfil balanceado em termos de tipo de medalha.

Podemos confirmar matematicamente fazendo um teste de independência.

\begin{center}
\hipoteses{A diferença entre homens e mulheres segue uma distribuição simétrica em torno de zero}{A diferença entre homens e mulheres não segue uma distribuição simétrica em torno de zero}
\end{center}


```{r}
tabela_medalha <- table(top_3_atletas$Nome, top_3_atletas$Medalha)

teste_qui <- chisq.test(tabela_medalha)
teste_qui_df <- data.frame(
  Estatística = teste_qui$statistic,
  Graus_de_Liberdade = teste_qui$parameter,
  P_valor = teste_qui$p.value
)

#knitr::kable(teste_qui_df, caption = "Resultados do teste qui-quadrado",col.names = c("","Estatítica","Graus de Liberdade","P-valor"))

```

```{=latex}
\begin{quadro}[H]
\centering
\caption{Resultados do teste Qui-Quadrado}
\setlength{\tabcolsep}{5pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|c|c|}
       \hline
       \textbf{Estatística} & \textbf{Estatísticado teste} & \textbf{Graus de Liberdade} & \textbf{P-valor} &\textbf{Decisão do teste} \\
       \hline
       X-quadrado & 12.77 & 4 &  0,012 & Rejeita $H_0$ \\
       \hline
\end{tabular}
\label{resultado_quadrado}
\end{quadro}

```

Para verificar se existia uma relação estatisticamente significativa entre os atletas e os tipos de medalhas, realizo-se um teste qui-quadrado de independência. Os resultados do teste indicaram um valor de X-quadrado de 12,77 com 4 graus de liberdade e um valor-p de 0,012. Este valor-p, sendo inferior ao nível de significância de 5%, que levou a rejeitar a hipótese nula de independência entre as variáveis. Ou seja, os resultados indicam que existe uma relação significativa entre os atletas analisados e os tipos de medalhas que conquistaram. Isso sugere que a distribuição das medalhas de ouro, prata e bronze não ocorre de forma uniforme entre os três atletas, havendo diferenças marcantes.


## Variação Peso por Altura

A análise realizada tem como objetivo compreender a relação entre o peso e a altura dos atletas, investigando se existe uma correlação direta entre essas variáveis. Em outras palavras, a análise busca responder se, à medida que o peso aumenta, a altura dos atletas também tende a aumentar, ou se não há uma relação clara entre essas duas características físicas. Para essa análise, são utilizadas as variáveis peso e altura, ambas sendo variáveis quantitativas contínuas. A altura para essa análise pode variar de 1,39 a 2,07 e o peso para essa análise pode variar de 30,9 a 174,9.


```{r}
# 4) Variação Peso por Altura (03/10) ----
# O intuito é entender a relação entre o peso e altura dos atletas. À medida que o peso aumenta,
# a altura também aumenta? Ou o contrário, ou não tem diferença, ou não dá pra inferir nada?

olimpiadas_Alt_Pes <- olimpiadas %>%
  filter(!is.na(Medalha),!is.na(Altura),!is.na(Peso))%>%
  distinct(Nome, .keep_all = TRUE)
```

```{r fig.cap="Gráfico de disperssão da Altura e Peso dos Atletas", fig.align="center"}
ggplot(olimpiadas_Alt_Pes) +
  aes(x = Altura, y = Peso) +
  geom_point(color = "#A11D21", size = 2,alpha = 0.5) +
  geom_smooth(method = "lm", size = 0.8, color = "#041835") +
  labs(
    x = "Altura (m)",
    y = "Peso (kg)"
  ) +
  theme_estat()
```

Pode-se observar uma correlação positiva entre altura e peso, onde, à medida que a altura dos atletas aumenta, o peso tende a aumentar também.  Sugerindo que atletas mais altos geralmente têm um peso. A dispersão dos pontos em torno da linha de tendência mostra, no entanto, uma variação considerável. Atletas de mesma altura apresentam pesos diferentes, o que pode refletir a diversidade de esportes e de composição corporal, onde fatores como a quantidade de massa muscular e gordura influenciam significativamente o peso.


```{r fig.cap="Distribuição da Altura dos Atletas", fig.align="center"}
# 2. Verificação de Normalidade com Gráficos de Distribuição
ggplot(olimpiadas_Alt_Pes, aes(x = Altura)) +
  geom_histogram(binwidth = 0.05, fill = "#A11D21", colour = "white") +
  labs(x = "Altura (m)", y = "Frequência") +
  theme_estat()
```

O gráfico da distribuição da altura dos atletas apresenta uma forma aproximadamente simétrica, centrada em torno de 1,75 metros, sugerindo que a maioria dos atletas tem altura próxima desse valor. A distribuição tem um padrão semelhante ao de uma distribuição normal, embora possa haver uma leve assimetria ou variação nas caudas, o que seria melhor avaliado com testes específicos de normalidade.

```{r fig.cap="Distribuição do Peso dos Atletas", fig.align="center"}
ggplot(olimpiadas_Alt_Pes, aes(x = Peso)) +
  geom_histogram(binwidth = 7, fill = "#A11D21", colour = "white") +
  labs( x = "Peso (kg)", y = "Frequência")+
  theme_estat()
```

O gráfico da distribuição do peso dos atletas mostra que é mais assimétrica e apresenta uma cauda longa à direita, indicando que há atletas com pesos mais elevados, mas que representam uma menor proporção da amostra. A maior concentração está entre 50 e 80 kg, o que sugere uma tendência mais centralizada dentro dessa faixa. Essa assimetria positiva é comum em variáveis como peso, onde existem poucos valores muito altos.

```{r}
# Análise Diagnóstica do Modelo (Diagnóstico de resíduos)

modelo_simples <- lm(Altura ~ Peso, data = olimpiadas_Alt_Pes)
summary_modelo <- summary(modelo_simples)


residuos <- rstandard(modelo_simples)  # resíduos padronizados
valores_ajustados <- fitted(modelo_simples)  # valores ajustados
dados <- data.frame(residuos, valores_ajustados)

# Gráfico 1: Residuals vs Fitted
g1 <- ggplot(dados, aes(x = valores_ajustados, y = residuos)) +
  geom_point(color = "#A11D21", alpha = 0.6) +
  geom_smooth(method = "loess", color = "black", se = FALSE) +
  labs(x = "Valores Ajustados", y = "Resíduos Padronizados") +
  ggtitle("Resíduos vs Ajustados") +
  theme_minimal()

# Gráfico 2: Q-Q Plot dos Resíduos
g2 <- ggplot(dados, aes(sample = residuos)) +
  stat_qq(color = "#A11D21") +
  stat_qq_line(size = 0.8, color = "black") +
  labs(x = "Quantis Teóricos", y = "Resíduos Padronizados") +
  ggtitle("Q-Q Plot") +
  theme_minimal()

# Gráfico 3: Scale-Location Plot
g3 <- ggplot(dados, aes(x = valores_ajustados, y = sqrt(abs(residuos)))) +
  geom_point(color = "#A11D21", alpha = 0.6) +
  geom_smooth(method = "loess", color = "black", se = FALSE) +
  labs(x = "Valores Ajustados", y = "Resíduos Padronizados") +
  ggtitle("Localização da escala") +
  theme_minimal()

# Gráfico 4: Residuals vs Leverage
g4 <- ggplot(data.frame(residuos, leverage = hatvalues(modelo_simples)), aes(x = leverage, y = residuos)) +
  geom_point(color = "#A11D21", alpha = 0.6) +
  geom_smooth(method = "loess", color = "black", se = FALSE) +
  labs(x = "Leverage", y = "Resíduos Padronizados") +
  ggtitle("Resíduos vs Alavancagem") +
  theme_minimal()

# Combinando os gráficos
(g1 | g2) / (g3 | g4)
```



Para o gráfico resíduos vs ajustados avalia-se a suposição de linearidade e se a variância dos resíduos é constante. Neste caso, a falta de um padrão claro nos resíduos ao redor de zero indica uma possível adequação, mas a leve tendência curvada sugere alguma possível violação de linearidade. No gráfico q-q plot verifica-se a normalidade dos resíduos. No seu gráfico, a maioria dos pontos segue a linha teórica, mas há desvios nas extremidades, o que indica que os resíduos podem não ser perfeitamente normais (presença de caudas mais pesadas). Já o gráfico localizaçãoda escala também verifica-se a homocedasticidade,ou seja, variância constante dos resíduos. Uma tendência ascendente indica que a variância dos resíduos aumenta com os valores ajustados, sugerindo heterocedasticidade. Por fim, para os resíduos vs alavancagem mostra que a influência de pontos específicos. Observações fora das linhas de Cook’s distance podem ser pontos influentes que afetam o modelo de forma desproporcional. Neste gráfico, alguns pontos aparecem próximos às linhas, o que indica que esses pontos podem ter grande influência na regressão.

```{r}
print_quadro <- function(data, var_name, title="Medidas resumo da(o) [nome da variável]", label="quad:quadro_resumo1") {
  var_name <- substitute(var_name)
  data <- data %>%
    summarize(
      `Média` = round(mean(!!sym(var_name)), 2),
      `Desvio Padrão` = round(sd(!!sym(var_name)), 2),
      `Variância` = round(var(!!sym(var_name)), 2),
      `Mínimo` = round(min(!!sym(var_name)), 2),
      `1º Quartil` = round(quantile(!!sym(var_name), probs = 0.25), 2),
      `Mediana` = round(quantile(!!sym(var_name), probs = 0.5), 2),
      `3º Quartil` = round(quantile(!!sym(var_name), probs = 0.75), 2),
      `Máximo` = round(max(!!sym(var_name)), 2)
    ) %>%
    t() %>%
    as.data.frame() %>%
    rownames_to_column("Estatística")
  print(data)
}
```

```{r}
olimpiadas_Alt_Pes$Altura_Bin <- cut(olimpiadas_Alt_Pes$Altura, breaks = seq(1.3, 2.2, by = 0.1), right = FALSE)

olimpiadas_Alt_Pes$Peso_Bin <- cut(olimpiadas_Alt_Pes$Peso, breaks = seq(20, 120, by = 10), right = FALSE)

estatisticas_Altura <- olimpiadas_Alt_Pes %>%
  group_by(Altura_Bin) %>%
  summarise(Tamanho_amostral = n(),
            Média = mean(IMC, na.rm = TRUE),
            Mediana = median(IMC, na.rm = TRUE),
            Desvio_padrão = sd(IMC, na.rm = TRUE),
            Mín = min(IMC, na.rm = TRUE),
            Máx = max(IMC, na.rm = TRUE))
#knitr::kable(estatisticas_Altura, caption = "Tabela das estatísticas descritivas da Altura dos Atletas", col.names = c("Altura","Tamanho Amostral","Média","Mediana","Desvio padrão","Min","Max"))
```

```{r}
#print_quadro(olimpiadas_Alt_Pes, "Altura", title = "Medidas resumo da Altura", label = "quad:quadro_resumo_altura")

```

```{=latex}
\begin{quadro}[H]
	\setlength{\tabcolsep}{9pt}
	\renewcommand{\arraystretch}{1.20}
	\caption{Medidas resumo da Altura}
	\centering
	\begin{tabular} { | l |
			S[table-format = 1.2]
			|}
	\hline
		\textbf{Estatística} & \textbf{Valor} \\
		\hline
		Média & 1.78 \\
		Desvio Padrão & 0.12 \\
		Variância & 0.01 \\
		Mínimo & 1.37 \\
		1º Quartil & 1.70 \\
		Mediana & 1.78 \\
		3º Quartil & 1.86 \\
		Máximo & 2.19 \\
	\hline
	\end{tabular}
	\label{quad:quadro_resumo_v11}
\end{quadro}

```

Com base no quadro 7 temos qua a média da altura é de 1,78 metros, indicando que, em geral, os indivíduos têm uma estatura próxima a esse valor. O desvio padrão de 0,12 metros mostra que há uma variação pequena ao redor da média, sugerindo que a maioria dos indivíduos tem alturas próximas a essa média. A variância, outra medida de dispersão, é de 0,01, o que confirma essa baixa variabilidade. Quanto aos valores extremos e à distribuição da altura, o mínimo é de 1,37 metros e o máximo é de 2,19 metros, o que estabelece o intervalo total das alturas observadas. 

```{r}
estatisticas_Peso <- olimpiadas_Alt_Pes %>%
  group_by(Peso_Bin) %>%
  summarise(Tamanho_amostral = n(),
            Média = mean(IMC, na.rm = TRUE),
            Mediana = median(IMC, na.rm = TRUE),
            Desvio_padrão = sd(IMC, na.rm = TRUE),
            Mín = min(IMC, na.rm = TRUE),
            Máx = max(IMC, na.rm = TRUE))
#knitr::kable(estatisticas_Peso, caption = "Tabela das estatísticas descritivas do Peso dos Atletas", col.names = c("Peso","Tamanho Amostral","Média","Mediana","Desvio padrão","Min","Max"))
```

```{r}

#print_quadro(olimpiadas_Alt_Pes, "Peso", title = "Medidas resumo do Peso", label = "quad:quadro_resumo_peso")

```

```{=latex}
\begin{quadro}[H]
	\setlength{\tabcolsep}{9pt}
	\renewcommand{\arraystretch}{1.20}
	\caption{Medidas resumo do Peso}
	\centering
	\begin{tabular} { | l |
			S[table-format = 3.2]
			|}
	\hline
		\textbf{Estatística} & \textbf{Valor} \\
		\hline
		Média & 74.15 \\
		Desvio Padrão & 16.25 \\
		Variância & 264.13 \\
		Mínimo & 28.00 \\
		1º Quartil & 63.00 \\
		Mediana & 72.00 \\
		3º Quartil & 84.00 \\
		Máximo & 175.00 \\
	\hline
	\end{tabular}
	\label{quad:quadro_resumo_v11}
\end{quadro}

```

De acordo com o quadro 8 a média do peso dos atletas é de 74,15 kg, indicando o valor central dessa distribuição. O desvio padrão de 16,25 kg indica a variabilidade ou dispersão dos valores em torno da média, sendo assim o peso dos atletas está relativamente disperso. A variância é de 264,13, mopstrando uma alta dispersão dos dados. O mínimo registrado é 28 kg, enquanto o máximo chega a 175 kg, o que mostra uma grande variabilidade de pesos entre os atletas. Os quartis dividem os dados em quatro partes iguais, sendo o primeiro quartil 63 kg, a mediana 72 kg e o terceiro quartil 84 kg. A mediana indica que metade dos atletas tem peso abaixo de 72 kg e a outra metade acima, enquanto o intervalo interquartil ( 84 - 63 = 21) sugere que a maior parte dos atletas tem pesos concentrados entre 63 kg e 84 kg.




```{r}
# Teste de Anderson-Darling
# install.packages("nortest")

library(nortest)

norm.alt <- ad.test(olimpiadas_Alt_Pes$Altura)
norm.pes <- ad.test(olimpiadas_Alt_Pes$Peso)

norm.alt.df <- data.frame(Statistic = norm.alt$statistic, P.Value = norm.alt$p.value)
norm.pes.df <- data.frame(Statistic = norm.pes$statistic, P.Value = norm.pes$p.value)

#knitr::kable(norm.alt.df, caption = "Tabela da normalidade da Altura dos Atletas", col.names = c("Estatística", "Valor P"))
#knitr::kable(norm.pes.df, caption = "Tabela da normalidade do Peso dos Atletas", col.names = c("Estatística", "Valor P"))

```

\begin{center}
\hipoteses{Os dados vêm de uma distribuição normal}{Os dados não vêm de uma distribuição normal}
\end{center}

```{=latex}
\begin{quadro}[H]
\centering
\caption{Tabela da Normalidade da Altura dos Atletas}
\setlength{\tabcolsep}{9pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|c|}
       \hline
       \textbf{Estatística} & \textbf{Valor} & \textbf{P-valor} & \textbf{Decisão do teste} \\
       \hline
       A & 6,42 & \textless 0,001 & Rejeita $H_0$ \\
       \hline
\end{tabular}
\label{resultado_normalidade}
\end{quadro}
```

```{=latex}
\begin{quadro}[H]
\centering
\caption{Tabela da Normalidade do Peso dos Atletas}
\setlength{\tabcolsep}{9pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|c|}
       \hline
       \textbf{Estatística} & \textbf{Valor} & \textbf{P-valor} & \textbf{Decisão do teste} \\
       \hline
       A & 40,83 & \textless 0,001 & Rejeita $H_0$ \\
       \hline
\end{tabular}
\label{resultado_normalidade_peso}
\end{quadro}

```

Para verificar se essas variáveis seguem uma distribuição normal, foi realizado o Teste de Anderson-Darling, que é utilizado para avaliar a normalidade dos dados de grandes amostras. Tanto para a altura quanto para o peso, os resultados apontaram p-valores extremamente baixos, o que leva à rejeição da hipótese nula de normalidade. Isso indica que tanto o peso quanto a altura dos atletas não seguem uma distribuição normal, sendo distribuídos de maneira assimétrica.

```{r}

resutado_corre <- cor(olimpiadas_Alt_Pes$Altura, olimpiadas_Alt_Pes$Peso, method = "pearson")
#cat("Coeficiente de Correlação de Pearson entre Altura e Peso:", resutado_corre, "\n")

```


```{r}
modelo_simples <- lm(Altura ~ Peso, data = olimpiadas_Alt_Pes)
summary_modelo <- summary(modelo_simples)

coeficientes_df <- as.data.frame(summary_modelo$coefficients)

# knitr::kable(coeficientes_df, caption = "Resultados da Regressão Linear Simples para Altura em função do Peso", col.names = c("Estimativa", "Erro Padrão", "Estatística t", "P-valor"))

```

```{=latex}

\begin{quadro}[H]
\centering
\caption{Resultados da Regressão Linear Simples para Altura em função do Peso}
\setlength{\tabcolsep}{9pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|c|c|}
       \hline
       \textbf{Variável} & \textbf{Estimativa} & \textbf{Erro Padrão} & \textbf{Estatística t} & \textbf{P-valor} \\
       \hline
       Intercepto & 1,36 & 0,01 & 348,08 & \textless 0,001 \\
       Peso & 0,01 & 0,001 & 111,37 & \textless 0,001\\
       \hline
\end{tabular}
\label{resultado_regressao_linear}
\end{quadro}

```

Para investigar a relação entre peso e altura, foi realizada uma análise de regressão linear, onde a altura foi ajustada em função do peso. O modelo ajustado revelou uma equação onde a altura aumenta conforme o peso aumenta. O coeficiente de regressão associado ao peso foi positivo e estatisticamente significativo, reforçando a ideia de que há uma relação positiva entre as duas variáveis.

```{r, echo=FALSE}

#cat("Resultado do teste F da regressão (p-valor):", summary(modelo_simples)$coefficients[2,4], "\n")
#if (summary(modelo_simples)$coefficients[2,4] < 0.05) {
#  cat("O efeito do Peso sobre a Altura é estatisticamente significativo.\n")
#} else {
#  cat("O efeito do Peso sobre a Altura NÃO é estatisticamente significativo.\n")
#}
```

```{=latex}
\begin{quadro}[H]
\centering
\caption{Resultado do Teste F da Regressão}
\setlength{\tabcolsep}{7pt}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|}
       \hline
       \textbf{Teste} & \textbf{P-valor}  \\
       \hline
       Teste F da Regressão & \textless 0,001  \\
       \hline
\end{tabular}
\label{testef}
\end{quadro}
```

O teste F realizado na regressão revelou um p-valor de < 0,001, indicando que o efeito do peso sobre a altura é estatisticamente significativo ao nível de 5%. Isso implica que a variação no peso dos atletas está significativamente associada a variações na altura, com uma probabilidade muito baixa de que essa associação seja devida ao acaso. Esse resultado nos permite concluir que há uma relação linear significativa entre as variáveis peso e altura para o conjunto de dados analisado. Contudo, é importante destacar que, embora a significância estatística indique uma associação, ela não revela a intensidade da relação, que pode ser observada pelo coeficiente de correlação de Pearson (0,79), além do coeficiente de determinação na análise de regressão.





# Conclusões

A diferença expressiva entre os Estados Unidos e os demais países sugere uma forte tradição e investimento no esporte feminino, refletindo-se em um número maior de atletas de alto nível. Por outro lado, Rússia e China também se destaquem, a diferença na quantidade de medalhistas são significativamente menores quando comparadas aos Estados Unidos.

Notou-se diferenças significativas no IMC entre as modalidades esportivas analisadas (Atletismo, Badminton, Futebol, Ginástica e Judô). Devido à não normalidade dos dados, foi aplicado o teste de Kruskal-Wallis, que confirmou essas diferenças. O Judô apresentou os maiores valores de IMC, refletindo um perfil corporal robusto, enquanto Ginástica e Atletismo mostraram IMCs mais baixos, associados à agilidade. Futebol e Badminton ficaram em posição intermediária, com valores de IMC superiores aos de Ginástica e Atletismo, mas abaixo dos do Judô.

Observou-se que os três principais medalhistas olímpicos – Phelps, Coughlin e Lochte – têm padrões distintos de conquistas de medalhas. Phelps se destacou pela grande quantidade de ouros, enquanto Coughlin e Lochte apresentaram um equilíbrio maior entre as diferentes medalhas. Esse padrão foi confirmado pelo teste qui-quadrado, evidenciando a diversidade no desempenho dos atletas e como diferentes fatores podem influenciar o sucesso olímpico.


Por fim, confirmou-se uma correlação positiva significativa entre o peso e a altura dos atletas, reforçando a ideia de que, em muitas modalidades, existe uma relação entre essas características físicas. Esse resultado abre portas para investigações mais detalhadas sobre como as características corporais podem impactar o desempenho nos Jogos Olímpicos.




