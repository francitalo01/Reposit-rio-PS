---
title: "House of excellence"

# Nome do documento PDF gerado
output-file: House of excellence
---

```{r}
#| include: false
source("rdocs/source/packages.R")
```

```{r}
#| include: false
# Pacotes ----
pacman::p_load(tidyverse,readxl,lubridate,janitor,ggplot2,dplyr,tidytext,knitr,car)

# Diretorio de trabalho
setwd("C:/Users/Francisco Italo/Documents")

# Leitura dos dados
sydney_2000<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 4) # 2000
athina_2004<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 1) # 2004
beijing_2008<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 5) # 2008
london_2012<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 2)# 2012
rio_2016<-read_xlsx("Olimpiadas_2000_2016.xlsx", sheet = 3) # 2016

# Renomeando as variaveis
sydney_2000 <- sydney_2000 %>% 
  rename(c(Name = N4m3, Sex = S3x, Age = "4g3", Height = "H31ght", Weight = "W31ght", Team = T34m, Sport = Sp0rt, Event = "3v3nt", Medal = M3d4l))

athina_2004 <- athina_2004 %>% 
  rename(c(Name = Names, Sex = Gender, Age = Age, Height = "Height (cm)", Weight = "Weight (lbs)", Team = Team, Sport = Sport, Event = Event, Medal = Medal))

beijing_2008 <- beijing_2008 %>% 
  rename(c(Name = Names, Sex = Sex, Age = Age, Height = Height, Weight = Weight, Team = Team, Sport = Sport, Event = Event, Medal = Medal))

london_2012 <- london_2012 %>% 
  rename(c(Name = Name, Sex = Sex, Age = Age, Height = Height, Weight = Weight, Team = Team, Sport = Sport, Event = Event, Medal = Medal))

rio_2016 <- rio_2016 %>% 
  rename(c(Name = Name, Sex = Sex, Age = Age_year, Height = Height_cm, Weight = Weight_lbs, Team = Country, Sport = Sport, Event = Event, Medal = Medal))

# Transformando os dados ----

# Convertando lbs para kg
sydney_2000$Weight <- sydney_2000$Weight * 0.453592
athina_2004$Weight <- athina_2004$Weight * 0.453592
beijing_2008$Weight <- beijing_2008$Weight * 0.453592
london_2012$Weight <- london_2012$Weight * 0.453592
rio_2016$Weight <- rio_2016$Weight * 0.453592

# Altura cm para m

sydney_2000$Height <- sydney_2000$Height / 100
athina_2004$Height <- athina_2004$Height / 100
beijing_2008$Height <- beijing_2008$Height / 100
london_2012$Height <- london_2012$Height / 100
rio_2016$Height <- rio_2016$Height / 100

# Sexo
sydney_2000 %>% distinct(Sex)
sydney_2000$Sex <- as.factor(sydney_2000$Sex)

athina_2004 %>% distinct(Sex)
athina_2004$Sex <- as.factor(athina_2004$Sex)

beijing_2008 %>% distinct(Sex)
beijing_2008$Sex <- as.factor(beijing_2008$Sex)

london_2012 %>% distinct(Sex)
london_2012$Sex <- as.factor(london_2012$Sex)

rio_2016 %>% distinct(Sex)
rio_2016$Sex <- as.factor(rio_2016$Sex)

# Sedes das olimpiadas
sydney_2000 <- sydney_2000 %>% mutate(Olimpiada = "Sydney")
athina_2004 <- athina_2004 %>% mutate(Olimpiada = "Athina")
beijing_2008 <- beijing_2008 %>% mutate(Olimpiada = "Beijing")
london_2012 <- london_2012 %>% mutate(Olimpiada = "London")
rio_2016 <- rio_2016 %>% mutate(Olimpiada = "Rio")

# Juntando os dados

olimpiadas <- rbind(sydney_2000,athina_2004,beijing_2008,london_2012,rio_2016)

sydney_2000 <- sydney_2000 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

athina_2004 <- athina_2004 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

beijing_2008 <- beijing_2008 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

london_2012 <- london_2012 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

rio_2016 <- rio_2016 %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

olimpiadas <- olimpiadas %>%
  rename(
    Nome = Name,
    Sexo = Sex,
    Idade = Age,
    Altura = Height,
    Peso = Weight,
    Time = Team,
    Esporte = Sport,
    Evento = Event,
    Medalha = Medal,
    Olimpiada = Olimpiada)

# Tema da Estat
cores_estat <- c("#A11D21", "#003366", "#CC9900", "#663333", "#FF6600", "#CC9966", "#999966", "#006606", "#008091", "#041835", "#666666")

theme_estat <- function(...) {
  theme <- ggplot2::theme_bw() +
    ggplot2::theme(
      axis.title.y = ggplot2::element_text(colour = "black", size = 12),
      axis.title.x = ggplot2::element_text(colour = "black", size = 12),
      axis.text = ggplot2::element_text(colour = "black", size = 9.5),
      panel.border = ggplot2::element_blank(),
      axis.line = ggplot2::element_line(colour = "black"),
      legend.position = "top",
      ...
    )
  
  return(
    list(
      theme,
      scale_fill_manual(values = cores_estat),
      scale_colour_manual(values = cores_estat)
    )
  )
}

```

```{r}
print_quadro_resumo <- function(data, var_name, title="Medidas resumo da(o) [nome da variável]", label="quad:quadro_resumo1")
{
  var_name <- substitute(var_name)
  data <- data %>%
    summarize(`Média` = round(mean(!!sym(var_name)),2),
              `Desvio Padrão` = round(sd(!!sym(var_name)),2),
              `Variância` = round(var(!!sym(var_name)),2),
              `Mínimo` = round(min(!!sym(var_name)),2),
              `1º Quartil` = round(quantile(!!sym(var_name), probs = .25),2),
              `Mediana` = round(quantile(!!sym(var_name), probs = .5),2),
              `3º Quartil` = round(quantile(!!sym(var_name), probs = .75),2),
              `Máximo` = round(max(!!sym(var_name)),2)) %>%
    t() %>% 
    as.data.frame() %>%
    rownames_to_column()
  
  latex <- str_c("\\begin{quadro}[H]
\t\\setlength{\t\\tabcolsep}{9pt}
\t\\renewcommand{\t\\arraystretch}{1.20}
\t\\caption{", title, "}
\t\\centering
\t\\begin{adjustbox}{max width=\\textwidth}
\t\\begin{tabular} {", sep="")
  
  col_count <- ncol(data)
  row_count <- nrow(data)
  latex <- str_c(latex, "| l |\n", sep=" ")
  for (i in seq(2, col_count))
  {
    numCount <- data[i, -c(1)] %>%
      as.numeric() %>%
      {floor(log10(.)) + 1} %>%
      max()
    latex <- str_c(latex, "\t\t\tS[table-format = ", numCount ,".2]\n", sep="")
  }
  
  
  latex <- str_c(latex, "\t\t\t|}\n\t\\hline\n\t\t", sep="")
  if (col_count > 2)
  {
    for (i in seq(1,col_count))
    {
      if (i == 1)
        latex <- str_c(latex, "\\textbf{Estatística}", sep="")
      else
        latex <- str_c(latex, " \\textbf{", data[1, i], "}", sep="")
      
      if (i < col_count)
        latex <- str_c(latex, "&", sep=" ")
      else
        latex <- str_c(latex, "\\\\\n", sep=" ")
    }
  }
  else
  {
    latex <- str_c(latex, "\\textbf{Estatística} & \\textbf{Valor} \\\\\n", sep="")  
  }
  
  latex <- str_c(latex, "\t\t\\hline\n", sep="")
  
  if (col_count > 2)
    starting_number <- 2
  else
    starting_number <- 1
  
  for (i in seq(starting_number, row_count))
  {
    latex <- str_c(latex, "\t\t", str_flatten(t(data[i,]), collapse = " & "), " \\\\\n")
  }
  
  latex <- str_c(latex, "\t\\hline
\t\\end{tabular}
\t\\label{", label, "}
\t\\end{adjustbox}
\\end{quadro}", sep="")
  
  writeLines(latex)
}
```


# Introdução

O projeto tem como objetivo auxiliar João Neves, proprietário da academia de alta performance House of Excellence, na otimização do desempenho de seus atletas de elite, com base em análises estatísticas de suas participações nas edições dos Jogos Olímpicos de 2000 a 2016. O foco das análises é identificar padrões de desempenho, características físicas e fatores relacionados às conquistas de medalhas, oferecendo insights valiosos para melhorar a preparação e a performance futura dos atletas.

Segundo parágrafo: detalhar quais são as análises que serão feitas. TODOS OS TIPOS DE ANÁLISES, se é análise descritiva , teste de hipóteses, regressão. Descrever um pouco sobre o banco de dados( quantidade de variáveis, tipos de variáveis, etc)..

As análises foram realizadas utilizando o software R, versão 4.4.1, com pacotes especializados para manipulação de dados, visualização gráfica e modelagem estatística.

# Referencial Teórico

## Frequência Relativa

A frequência relativa é utilizada para a comparação entre classes de uma variável categórica com $c$ categorias, ou para comparar uma mesma categoria em diferentes estudos.

A frequência relativa da categoria $j$ é dada por:

$$
f_j=\frac{n_j}{n}
$$

Com:

-   $j = 1, \, ..., \, c$

-   $n_j =$ número de observações da categoria $j$

-   $n =$ número total de observações

Geralmente, a frequência relativa é utilizada em porcentagem, dada por:

$$100 \times f_j$$

## Média

A média é a soma das observações dividida pelo número total delas, dada pela fórmula:

$$\bar{X}=\frac{\sum\limits_{i=1}^{n}X_i}{n}$$

Com:

-   $i = 1, \, 2, \, ..., \, n$

-   $n =$ número total de observações

## Mediana

Sejam as $n$ observações de um conjunto de dados $X=X_{(1)},X_{(2)},\ldots, X_{(n)}$ de determinada variável ordenadas de forma crescente. A mediana do conjunto de dados $X$ é o valor que deixa metade das observações abaixo dela e metade dos dados acima.

Com isso, pode-se calcular a mediana da seguinte forma:

$$
med(X) =
    \begin{cases}
         X_{\frac{n+1}{2}}, \textrm{para n ímpar} \\
         \frac{X_{\frac{n}{2}}+X_{\frac{n}{2} + 1}}{2}, \textrm{para n par} \\
    \end{cases}
$$

## Quartis

Os quartis são separatrizes que dividem o conjunto de dados em quatro partes iguais. O primeiro quartil (ou inferior) delimita os 25% menores valores, o segundo representa a mediana, e o terceiro delimita os 25% maiores valores. Inicialmente deve-se calcular a posição do quartil:

-   Posição do primeiro quartil $P_1$: $$P_1=\frac{n+1}{4}$$

-   Posição da mediana (segundo quartil) $P_2$: $$P_2 = \frac{n+1}{2}$$

-   Posição do terceiro quartil $P_3$: $$P_3=\frac{3 \times (n+1)}{4}$$

Com $n$ sendo o tamanho da amostra. Dessa forma, $X_{\left( P_i \right)}$ é o valor do $i$-ésimo quartil, onde $X_{\left( j \right)}$ representa a $j$-ésima observação dos dados ordenados.

Se o cálculo da posição resultar em uma fração, deve-se fazer a média entre o valor que está na posição do inteiro anterior e do seguinte ao da posição.

## Variância

A variância é uma medida que avalia o quanto os dados estão dispersos em relação à média, em uma escala ao quadrado da escala dos dados.

### Variância Populacional

Para uma população, a variância é dada por:

$$\sigma^2=\frac{\sum\limits_{i=1}^{N}\left(X_i - \mu\right)^2}{N}$$

Com:

-   $X_i =$ $i$-ésima observação da população

-   $\mu =$ média populacional

-   $N =$ tamanho da população

### Variância Amostral

Para uma amostra, a variância é dada por:

$$S^2=\frac{\sum\limits_{i=1}^{n}\left(X_i - \bar{X}\right)^2}{n-1}$$

Com:

-   $X_i =$ i-ésima observação da amostra

-   $\bar{X} =$ média amostral

-   $n =$ tamanho da amostra

## Desvio Padrão

O desvio padrão é a raiz quadrada da variância. Ele avalia o quanto os dados estão dispersos em relação à média.

### Desvio Padrão Populacional

Para uma população, o desvio padrão é dado por:

$$\sigma=\sqrt{\frac{\sum\limits_{i=1}^{N}\left(X_i - \mu\right)^2}{N}}$$

Com:

-   $X_i =$ i-ésima observação da população

-   $\mu =$ média populacional

-   $N =$ tamanho da população

### Desvio Padrão Amostral

Para uma amostra, o desvio padrão é dado por:

$$S=\sqrt{\frac{\sum\limits_{i=1}^{n}\left(X_i - \bar{X}\right)^2}{n-1}}$$

Com:

-   $X_i =$ i-ésima observação da amostra

-   $\bar{X} =$ média amostral

-   $n =$ tamanho da amostra

## Coeficiente de Variação

O coeficiente de variação fornece a dispersão dos dados em relação à média. Quanto menor for o seu valor, mais homogêneos serão os dados. O coeficiente de variação é considerado baixo (apontando um conjunto de dados homogêneo) quando for menor ou igual a 25%. Ele é dado pela fórmula:

$$C_V=\frac{S}{\bar{X}}\times 100$$

Com:

-   $S =$ desvio padrão amostral

-   $\bar{X} =$ média amostral

## Coeficiente de Assimetria

O coeficiente de assimetria quantifica a simetria dos dados. Um valor positivo indica que os dados estão concentrados à esquerda em sua função de distribuição, enquanto um valor negativo indica maior concentração à direita. A fórmula é:

$$C_{Assimetria} = \frac{1}{n}\times\sum\limits_{i=1}^{n} \left(\frac{X_i - \bar{X}}{S}\right)^3 $$

Com:

-   $X_i =$ i-ésima observação da amostra

-   $\bar{X} =$ média amostral

-   $S=$ desvio padrão amostral

-   $n=$ tamanho da amostra

## Curtose

O coeficiente de curtose quantifica o achatamento da função de distribuição em relação à distribuição Normal e é dado por:

$$Curtose = \frac{1}{n}\times\sum\limits_{i=1}^{n}\left(\frac{ X_i-\bar{X} }{S} \right)^4 - 3$$

Com:

-   $X_i =$ i-ésima observação da amostra

-   $\bar{X} =$ média amostral

-   $S =$ desvio padrão amostral

-   $n =$ tamanho da amostra

Uma distribuição é dita mesocúrtica quando possui curtose nula. Quando a curtose é positiva, a distribuição é leptocúrtica (mais afunilada e com pico). Valores negativos indicam uma distribuição platicúrtica (mais achatada).

## Boxplot

O boxplot é uma representação gráfica na qual se pode perceber de forma mais clara como os dados estão distribuídos. A figura abaixo ilustra um exemplo de boxplot.

![Exemplo de boxplot](images/box_uni.png){fig-align="center"}

A porção inferior do retângulo diz respeito ao primeiro quartil, enquanto a superior indica o terceiro quartil. Já o traço no interior do retângulo representa a mediana do conjunto de dados, ou seja, o valor em que o conjunto de dados é dividido em dois subconjuntos de mesmo tamanho. A média é representada pelo losango branco e os pontos são *outliers*. Os *outliers* são valores discrepantes da série de dados, ou seja, valores que não demonstram a realidade de um conjunto de dados.

## Histograma

O histograma é uma representação gráfica utilizada para a visualização da distribuição dos dados e pode ser construído por valores absolutos, frequência relativa ou densidade. A figura abaixo ilustra um exemplo de histograma.

![Exemplo de histograma](images/hist_uni.png){fig-align="center"}

## Gráfico de Dispersão

O gráfico de dispersão é uma representação gráfica utilizada para ilustrar o comportamento conjunto de duas variáveis quantitativas. A figura abaixo ilustra um exemplo de gráfico de dispersão, onde cada ponto representa uma observação do banco de dados.

![Exemplo de Gráfico de Dispersão](images/disp_uni.png){fig-align="center"}

## Tipos de Variáveis

### Qualitativas

As variáveis qualitativas são as variáveis não numéricas, que representam categorias ou características da população. Estas subdividem-se em:

-   **Nominais**: quando não existe uma ordem entre as categorias da variável (exemplos: sexo, cor dos olhos, fumante ou não, etc)
-   **Ordinais**: quando existe uma ordem entre as categorias da variável (exemplos: nível de escolaridade, mês, estágio de doença, etc)

### Quantitativas

As variáveis quantitativas são as variáveis numéricas, que representam características numéricas da população, ou seja, quantidades. Estas subdividem-se em:

-   **Discretas**: quando os possíveis valores são enumeráveis (exemplos: número de filhos, número de cigarros fumados, etc)
-   **Contínuas**: quando os possíveis valores são resultado de medições (exemplos: massa, altura, tempo, etc)

## Teste de Normalidade de Shapiro-Wilk

O **Teste de Shapiro-Wilk** é utilizado para verificar a aderência de uma variável quantitativa ao modelo da Distribuição Normal, sendo mais recomendado para amostras pequenas. A suposição de normalidade é importante para a determinação do teste a ser utilizado. As hipóteses a serem testadas são:

\hipoteses{A variável segue uma distribuição Normal}{A variável segue outro modelo}

A amostra deve ser ordenada de forma crescente para que seja possível obter as estatísticas de ordem. A estatística do teste é dada por:

$$ W = \frac{1}{D} \left[ \sum_{i=1}^{k} a_{i} \left(X_{(n-i+1)} - X_{(i)}\right) \right] $$

Com:

-   $K$ aproximadamente $\displaystyle\frac{n}{2}$

-   $X_{\left(i\right)} =$ estatística de ordem *i*

-   $D = \displaystyle \sum_{i=1}^{n}(X_{i} - \bar{X})^2$, em que $\bar{X}$ é a média amostral

-   \$a_i = \$ constantes que apresentam valores tabelados


## Teste de Kruskal-Wallis

O teste de Kruskal-Wallis é utilizado para comparar dois ou mais grupos independentes sem supor nenhuma distribuição. É um método baseado na comparação de postos, os quais são atribuídos a cada observação de uma variável quantitativa após serem ordenadas.

As hipóteses do teste de Kruskal-Wallis são formuladas da seguinte maneira:

\hipoteses{Não existe diferença entre os grupos}{Pelo menos um grupo difere dos demais}

A estatística do teste de Krukal-Waliis é definida da seguinte maneira:

$$
H_{Kruskal-Wallis}=
    \displaystyle\frac{\displaystyle\left[ \frac{12}{n(n+1)} \sum_{i=1}^{k} \frac{R_i^2}{n_i} \right] - 3(n+1)}
    {\displaystyle1- \left[ \frac{\displaystyle\sum_{j}^{}(t_j^3 - t_j)}{n^3 - n}\right]} 
\approx \chi^2_{(k-1)}
$$

Com: - $k=$ número de grupos

-   $R_i=$ soma dos postos do grupo i

-   $n_i=$ número de elementos do grupo i

-   $n=$ tamanho total da amostra

-   $t_{j}=$ número de elementos no j-ésimo empate (se houver)

Se o p-valor for menor que o nível de significância $\alpha$, rejeita-se a hipótese nula.

# Análises

## Top 5 países com maior número de mulheres medalhistas

A análise, buscamos identificar os países que tiveram o maior número de mulheres medalhistas em Jogos Olímpicos de 2000 a 2016. Utilizou-se dados das edições de Sydney 2000, Atenas 2004, Pequim 2008, Londres 2012 e Rio 2016, considerando as variáveis de sexo (feminino), país de origem das atletas (Team), e a presença de uma medalha (Medal). O objetivo principal foi compreender quais nações se destacaram em termos de conquistas femininas, utilizando como métricas o número total de medalhistas por país e a frequência relativa de cada país em relação ao total de mulheres medalhistas.

```{r fig.cap="Gráfico de barras dos 5 países com maior número de mulheres medalhistas", fig.align="center"}
# 1. Top 5 países com maior número de mulheres medalhistas (13/10)----
# O cliente gostaria de entender quais países possuem um maior número de mulheres que conquistaram medalhas, em ordem do país com maior número de mulheres medalhistas para o país com menor número.

# Total (Tabela pronta, mas falta colocar a padronização da Estat)
top_5_total <- olimpiadas %>%
  filter(Sexo == "F", !is.na(Medalha)) %>% 
  group_by(Time) %>%
  summarise(total_medalhistas = n(), .groups = 'drop') %>% 
  arrange(desc(total_medalhistas)) %>%
  slice_head(n = 5) %>%
  mutate (freq = round(100*(total_medalhistas/sum(total_medalhistas)), 2))  %>%
  mutate(freq = gsub("\\.", ",", freq) %>% 
           paste("%", sep = ""),label = str_c(total_medalhistas, " (", freq, ")") 
         %>% str_squish())

traducoes <- c(
  "United States" = "Estados Unidos",
  "Russia" = "Rússia",
  "China" = "China",
  "Australia" = "Austrália",
  "Germany" = "Alemanha"
)

top_5_total$Time <- traducoes[top_5_total$Time]

ggplot(top_5_total)+
  aes(x = reorder(Time, -total_medalhistas), y = total_medalhistas, label = label) +
  geom_bar(stat = "identity", fill = c("#A11D21"), width = 0.7) +
  geom_text(aes(label = label), position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
  labs(x = "País", y = "Número de Mulheres Medalhistas") +
  ylim(NA,800)+
  theme_estat()
```

Entre os anos de 2000 a 2016, os Estados Unidos se destacaram como o país com o maior número de mulheres medalhistas nas Olimpíadas, conquistando 741 medalhas, o que representa 34,48% do total. Em segundo lugar, a Rússia registrou 416 medalhas femininas, correspondendo a 19,36% do total. A China ocupa a terceira posição com 384 medalhas, o que equivale a 17,87% do total. A Austrália, com 340 medalhas (15,82%), é o quarto colocado. Por fim, a Alemanha completa o top 5 com 268 medalhas, representando 12,47% do total.

## Análise do IMC para os esportes selecionados

Nesta análise, busca-se comparar o Índice de Massa Corporal (IMC) de atletas olímpicos que competiram em diferentes modalidades esportivas, especificamente Atletismo, Badminton, Futebol, Ginástica e Judô. O objetivo é identificar se há diferenças significativas nos valores de IMC entre esses esportes, bem como entender quais esportes tendem a ter IMCs mais altos ou mais baixos.

$$
IMC = \frac{Peso(kg)}{Altura(m^2)}
$$
Em termos gerais, os valores de IMC podem ser categorizados da seguinte forma:


\begin{itemize}
    \item Abaixo de 18,5: Peso abaixo do ideal.
    \item 18,5 a 24,9: Peso normal ou saudável.
    \item 25,0 a 29,9: Sobrepeso.
    \item 30,0 a 34,9: Obesidade grau I.
    \item 35,0 a 39,9: Obesidade grau II.
    \item Acima de 40,0: Obesidade grau III.
\end{itemize}

```{r}
# 2 Valor IMC por esporte, estes sendo, ginástica, futebol, judô, atletismo e badminton (20/10) ----

# O cliente deseja comparar os valores do Índice de Massa Corporal (IMC) entre atletas de
# diferentes esportes, especificamente ginástica, judô, atletismo e badminton, para entender a
# variação entre eles e identificar se algum esporte tende a ter IMCs geralmente menores,
# maiores ou se não há diferença significativa. Para isso, é necessário calcular o IMC de cada
# atleta utilizando a fórmula peso (kg) / altura (m)2 e, em seguida, analisar os resultados para cada
# esporte selecionado, observando como os valores se comportam em relação aos esportes
# mencionados.

sydney_2000 <- sydney_2000 %>% 
  mutate(IMC = Peso / (Altura^2))

athina_2004 <- athina_2004 %>% 
  mutate(IMC = Peso / (Altura^2))

beijing_2008 <- beijing_2008 %>% 
  mutate(IMC = Peso / (Altura^2))

london_2012 <- london_2012 %>% 
  mutate(IMC = Peso / (Altura^2))

rio_2016 <- rio_2016 %>% 
  mutate(IMC = Peso / (Altura^2))

# Juntando os dados

olimpiadas <- rbind(sydney_2000,athina_2004,beijing_2008,london_2012,rio_2016)

traducoes_esportes <- c(
  "Athletics" = "Atletismo",
  "Badminton" = "Badminton",
  "Gymnastics" = "Ginástica",
  "Judo" = "Judô",
  "Sailing" = "Vela",
  "Wrestling" = "Luta",
  "Rowing" = "Remo",
  "Swimming" = "Natação",
  "Taekwondo" = "Taekwondo",
  "Diving" = "Saltos Ornamentais",
  "Football" = "Futebol",
  "Tennis" = "Tênis",
  "Cycling" = "Ciclismo",
  "Hockey" = "Hóquei",
  "Weightlifting" = "Levantamento de Peso",
  "Basketball" = "Basquete",
  "Volleyball" = "Voleibol",
  "Shooting" = "Tiro Esportivo",
  "Synchronized Swimming" = "Nado Sincronizado",
  "Boxing" = "Boxe",
  "Table Tennis" = "Tênis de Mesa",
  "Baseball" = "Beisebol",
  "Handball" = "Handebol",
  "Fencing" = "Esgrima",
  "Canoeing" = "Canoagem",
  "Water Polo" = "Polo Aquático",
  "Beach Volleyball" = "Vôlei de Praia",
  "Softball" = "Softbol",
  "Rhythmic Gymnastics" = "Ginástica Rítmica",
  "Archery" = "Tiro com Arco",
  "Equestrianism" = "Hipismo",
  "Modern Pentathlon" = "Pentatlo Moderno",
  "Triathlon" = "Triatlo",
  "Trampolining" = "Ginástica de Trampolim",
  "Rugby Sevens" = "Rúgbi de Sete",
  "Golf" = "Golfe"
)

olimpiadas <- olimpiadas %>% 
  mutate(Esporte = dplyr::recode(Esporte, !!!traducoes_esportes))

olimpiadas_IMC <- olimpiadas %>%
  filter(Esporte %in% c("Badminton", "Atletismo", "Judô", "Ginástica", "Futebol"), !is.na(Medalha))
```


```{r}
estatisticas_IMC <- olimpiadas_IMC %>%
  group_by(Esporte) %>%
  summarise(Tamanho_amostral = n(),
            Média = mean(IMC, na.rm = TRUE),
            Mediana = median(IMC, na.rm = TRUE),
            Desvio_padrão = sd(IMC, na.rm = TRUE),
            Mín = min(IMC, na.rm = TRUE),
            Máx = max(IMC, na.rm = TRUE))
knitr::kable(estatisticas_IMC, caption = "Tabela das estatísticas descritivas por esporte", col.names = c("Esporte","Tamanho Amostral","Média","Mediana","Desvio padrão","Min","Max"))
```

No Atletismo, a média do IMC é de 22,3, com uma mediana de 21,4 e um desvio padrão de 3,86. Isso sugere que os valores de IMC dos atletas são relativamente próximos, mas há alguns casos extremos, como evidenciado pelo valor máximo de 44,4.

Os atletas de Badminton apresentam uma média de IMC de 22,2, e uma mediana de 22,3, com um desvio padrão baixo de 1,50. Indicando uma menor variabilidade nos valores de IMC, com a maioria dos atletas concentrados em torno da média.

Os jogadores de Futebol apresentam uma média de IMC ligeiramente maior, de 22,5, e uma mediana de 22,5, com um desvio padrão baixo de 1,73. Isso indica uma menor variabilidade nos valores de IMC, com a maioria dos jogadores concentrados em torno da média.

Na Ginástica, o IMC médio é de 20,7, enquanto a mediana é de 21,1, e o desvio padrão é de 2,38, indicando também uma baixa variabilidade e uma distribuição mais homogênea dos valores de IMC entre os atletas.

Já os atletas de Judô apresentam a maior média de IMC, de 25,7, com uma mediana de 24,7 e um desvio padrão mais elevado, de 5,12. Esse maior desvio padrão sugere uma variabilidade significativa no IMC dos judocas, com um valor máximo de 56.5, indicando que alguns atletas possuem um IMC substancialmente maior, o que pode estar relacionado à necessidade de uma maior massa corporal nesse esporte de combate.

De acordo com os dados tem se os judocas tendem a ter um IMC mais elevados, enquanto os ginastas apresentam os menores. As diferenças na variabilidade entre os grupos refletem os distintos requisitos físicos de cada esporte, como força e agilidade.

```{r fig.cap="Boxplot da Comparação do IMC entre Esportes", fig.align="center"}

ggplot(olimpiadas_IMC, aes(x = Esporte, y = IMC, fill = Esporte)) +
  geom_boxplot(fill = c("#A11D21"), width = 0.5)+
  stat_summary(fun = "mean", geom = "point", shape = 23, size = 3, fill = "white")+
  labs(x = "Esporte", y = "IMC") +
  theme_estat()
```

Observa-se que os atletas de Atletismo e Badminton tendem a ter uma mediana de IMC menor em comparação aos de Ginástica e Judô, sugerindo que essas duas modalidades têm atletas com IMC menores. O Judô apresenta a maior mediana entre os esportes analisados, indicando uma tendência a ter um IMC mais elevados entre seus atletas.

O Judô se destaca por ter uma caixa maior, sugerindo mais variação no IMC dos seus atletas em comparação aos outros esportes. Por outro lado, os da Ginástica é menor, o que indica uma menor variação no IMC dos atletas dessa modalidade.

O boxplot também exibe varios pontos fora dos limites, também conhecidos com outliers, que representam valores atípicos. Esportes como Atletismo e Judô apresentam uma quantidade significativa de outliers, com alguns atletas tendo IMC consideravelmente mais altos que a maioria de seus pares na mesma modalidade.

### Normalidade

O teste de Shapiro-Wilk foi aplicado para cada esporte para verificar se os dados de IMC seguem uma distribuição normal.

```{r}
# Verificar a normalidade dos dados com o teste de Shapiro-Wilk
shapiro_results <- olimpiadas_IMC %>%
  group_by(Esporte) %>%
  summarise(n_obs = n(),p_value = ifelse(n_obs >= 3 & n_obs <= 5000,shapiro.test(IMC)$p.value,NA))
shapiro_results$p_value <- format(shapiro_results$p_value, scientific = TRUE)
knitr::kable(shapiro_results$p_value,caption = "Teste de Shapiro-Wilk",col.names = "P-valor")
```

Os valores-p resultantes para todos os esportes foram extremamente baixos, menores que um nível de significância preestabelecido de 5%, indicando que os dados não seguem uma distribuição normal.


### Teste de Kruskal-Wallis

Dada a violação da normalidade, foi aplicado o teste de Kruskal-Wallis, que é um teste não-paramétrico.

```{r}
# Caso os pressupostos de ANOVA não sejam atendidos, utilizar o teste de Kruskal-Wallis
kruskal_result <- kruskal.test(IMC ~ Esporte, data = olimpiadas %>% filter(Esporte %in% c("Ginástica", "Judô", "Atletismo","Futebol", "Badminton")))
result_df <- data.frame(
  Estatística = kruskal_result$statistic,
  p_value = kruskal_result$p.value,
  Número_de_grupos = length(unique(olimpiadas$Esporte)),
  Tamanho_da_amostra = nrow(olimpiadas)
)
result_df$p_value <- format(result_df$p_value, scientific = TRUE)
knitr::kable(result_df, caption = "Teste de Kruskal-Wallis", col.names = c("","Estatística", "P-valor", "Grupos", "Tamanho amostral"))
```

O resultado do p-valor foi menor que 5%, indicando diferenças significativas do IMC entre os grupos de esportes.

## Top 3 medalhistas gerais por quantidade de cada tipo de medalha


A análise tem como objetivo identificar os três atletas com mais medalhas nas Olimpíadas de 2000 (Sydney), 2004 (Atenas), 2008 (Pequim), 2012 (Londres) e 2016 (Rio), além de examinar a quantidade de cada tipo de medalha (ouro, prata e bronze) conquistada por eles. Também será investigada, por meio de métodos estatísticos como o teste qui-quadrado de independência, a existência de uma relação entre o atleta e o tipo de medalha.

```{r, echo=FALSE}
# 3) Top 3 medalhistas gerais por quantidade de cada tipo de medalha (27/10) ----
# O intuito dessa análise é primeiro entender quais são os 3 medalhistas com maior número de
# medalhas no total, e dentre eles, observar a quantidade de cada tipo de medalha que cada um
# destes atletas conquistou, sendo ouro, prata ou bronze. Existe relação entre o medalhista e
# cada tipo de medalha conquistada?

dados_medalha <- olimpiadas

# Remover linhas com valores ausentes, se houver
dados_medalha <- na.omit(dados_medalha)

# str(dados_medalha)
```


```{r}
medalhas_contadas <- dados_medalha %>%
  group_by(Nome) %>%
  summarise(Total_Medalhas = n())

top_3_medalhistas <- medalhas_contadas %>%
  top_n(3, Total_Medalhas)

knitr::kable(top_3_medalhistas, caption = "Tabela dos Medalhistas e Total de Medalhas",col.names = c("Nome","Total de Medalhas"))
```

Com base na tabela, identifica-se que os três atletas com o maior número de medalhas em todas as edições analisadas foram: Michael Fred Phelps, II, com um total de 28 medalhas; Natalie Anne Coughlin, com 12 medalhas; e Ryan Steven Lochte, também com 12 medalhas.

```{r}
top_3_atletas <- dados_medalha %>%
  filter(Nome %in% top_3_medalhistas$Nome)

tipo_medalha <- top_3_atletas %>%
  group_by(Nome, Medalha) %>%
  summarise(Count = n())

traducoes_medalha <- c(
  "Gold" = "Ouro",
  "Silver" = "Prata",
  "Bronze" = "Bronze"
)

tipo_medalha <- tipo_medalha %>% 
  mutate(Medalha = dplyr::recode(Medalha, !!!traducoes_medalha))

knitr::kable(tipo_medalha, caption = "Tabela da Distribuição das Medalhas", col.names = c("Nome","Medalha","Quantidade"))
```

A distribuição das medalhas revelou-se diferenças significativas entre os atletas. Michael Phelps, que se destacou como o maior medalhista, conquistou 23 medalhas de ouro, 3 de prata e 2 de bronze, tendo um desempenho excepcional em conquistas medalhas de ouro. Natalie Coughlin, por outro lado, teve uma distribuição mais equilibrada, com 3 medalhas de ouro, 4 de prata e 5 de bronze. Já Ryan Lochte obteve 6 medalhas de ouro, 3 de prata e 3 de bronze, também apresentando um perfil balanceado em termos de tipo de medalha.

```{r fig.cap="Gráfico de barras da distribuição das medalhas", fig.align="center"}
# Gráfico de barras mostrando a contagem de medalhas por tipo para os Top 3 atletas
ggplot(tipo_medalha, aes(x = Nome, y = Count, fill = Medalha)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Distribuição de Medalhas para os Top 3 Atletas Olímpicos",
       x = "Atleta", y = "Quantidade de Medalhas") +
  scale_fill_manual(values = c("#663333", "#CC9900", "#666666"))
```
A distribuição das medalhas foi visualizada em um gráfico de barras que evidenciou o predomínio de medalhas de ouro nas conquistas de Michael Phelps, enquanto Natalie Coughlin e Ryan Lochte apresentaram uma proporção mais distribuída entre os diferentes tipos de medalha.

```{r}

# Criar uma tabela de contingência entre Atleta e Tipo de Medalha
tabela_medalha <- table(top_3_atletas$Nome, top_3_atletas$Medalha)

teste_qui <- chisq.test(tabela_medalha)
teste_qui_df <- data.frame(
  Estatística = teste_qui$statistic,
  Graus_de_Liberdade = teste_qui$parameter,
  P_valor = teste_qui$p.value
)

knitr::kable(teste_qui_df, caption = "Resultados do teste qui-quadrado",col.names = c("","Estatítica","Graus de Liberdade","P-valor"))

```
Para verificar se existia uma relação estatisticamente significativa entre os atletas e os tipos de medalhas, realizo-se um teste qui-quadrado de independência. Os resultados do teste indicaram um valor de X-quadrado de 12,776 com 4 graus de liberdade e um valor-p de 0,01243. Este valor-p, sendo inferior ao nível de significância de 5%, que levou a rejeitar a hipótese nula de independência entre as variáveis. Ou seja, os resultados indicam que existe uma relação significativa entre os atletas analisados e os tipos de medalhas que conquistaram. Isso sugere que a distribuição das medalhas de ouro, prata e bronze não ocorre de forma uniforme entre os três atletas, havendo diferenças marcantes.


## Variação Peso por Altura

# Conclusões

A  primeira análise dos países com o maior número de mulheres medalhistas nos Jogos Olímpicos de 2000 a 2016 revelou um destaque claro dos Estados Unidos, que lideram com uma grande margem, possuindo 741 medalhistas, o que representa 34,48% do total. Em seguida, a Rússia ocupa a segunda posição com 416 medalhistas (19,36%), a China aparece logo atrás, com 384 medalhistas (17,87%). Austrália e Alemanha completam o Top 5, com 340 (15,82%) e 268 (12,47%) medalhistas, respectivamente.A diferença expressiva entre os Estados Unidos e os demais países sugere uma forte tradição e investimento no esporte feminino, refletindo-se em um número maior de atletas de alto nível. Por outro lado, Rússia e China também se destaquem, a diferença na quantidade de medalhistas são significativamente menores quando comparadas aos Estados Unidos.

Na segunda análise observou-se diferenças significativas no IMC entre as modalidades esportivas analisadas (Atletismo, Badminton, Futebol, Ginástica e Judô). Devido à não normalidade dos dados, foi aplicado o teste de Kruskal-Wallis, que confirmou essas diferenças. O Judô apresentou os maiores valores de IMC, refletindo um perfil corporal robusto, enquanto Ginástica e Atletismo mostraram IMCs mais baixos, associados à agilidade. Futebol e Badminton ficaram em posição intermediária, com valores de IMC superiores aos de Ginástica e Atletismo, mas abaixo dos do Judô.

Na terceira análise mostrou que há diferenças significativas na forma como os três principais medalhistas olímpicos conquistaram suas medalhas, com Phelps se destacando pelo número expressivo de ouros, enquanto Coughlin e Lochte apresentaram maior equilíbrio entre os diferentes tipos de medalha. Essas diferenças são estatisticamente relevantes, conforme evidenciado pelo teste qui-quadrado, e refletem as particularidades de desempenho de cada atleta ao longo de suas participações olímpicas. Esse entendimento pode contribuir para análises futuras sobre o impacto de diferentes fatores (como modalidade esportiva, preparo físico e características pessoais) no desempenho dos atletas olímpicos mais bem-sucedidos.




